// main.scss
---
# Jekyll front matter to process this file
---

// =============================================================================
// MAIN.SCSS - "IM" THEME FOR BULMA (Enji.dev Inspired - Single File)
// =============================================================================
// TABLE OF CONTENTS:
// -----------------------------------------------------------------------------
// 1.  CORE "IM" THEME SCSS VARIABLES (Raw Values)
// 2.  CSS CUSTOM PROPERTIES (:root - Light Mode & Dark Mode Definitions)
// 3.  BULMA GLOBAL VARIABLE OVERRIDES (Using $im- SCSS Variables)
// 4.  IMPORT BULMA FRAMEWORK
// 5.  BASE & HTML ELEMENT STYLES (Using CSS Custom Properties)
// 6.  LAYOUT COMPONENT STYLES
// 7.  ELEMENT STYLES
// 8.  COMPONENT COLLECTION STYLES (Navbar, Card, etc.)
// 9.  FORM ELEMENT STYLES
// 10. UTILITY STYLES (Background Grid)
// 11. PAGE TRANSITION ANIMATIONS
// 12. DARK MODE SPECIFIC COMPONENT ADJUSTMENTS (Minimal)
// =============================================================================


// =============================================================================
// 1. CORE "IM" THEME SCSS VARIABLES (Raw Values)
//    Define ALL $im- variables here BEFORE they are used anywhere else.
// =============================================================================
$im-font-family-sans-serif: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
$im-font-family-monospace: "Roboto Mono", Consolas, Monaco, monospace;

$im-font-weight-normal: 400;
$im-font-weight-medium: 500;
$im-font-weight-semibold: 600;
$im-font-weight-bold: 700;

$im-primary: #e53935;
$im-primary-light: #ef5350;
$im-primary-dark: #c62828;
$im-primary-inverse: #FFFFFF;

$im-link-color: $im-primary; // Derived from $im-primary
$im-link-hover-color: $im-primary-dark; // Derived from $im-primary-dark

$im-text: #2D3748;
$im-text-headings: #1A202C;
$im-text-muted: #718096;

$im-background: #f4f7f6;
$im-surface: #FFFFFF;
$im-surface-alt: #F0F2F5;

$im-border: #E2E8F0;
$im-border-light: #EFF2F7;
$im-border-hover: #D1D9E6;

$im-radius: 4px;
$im-radius-large: 6px;

$im-base-font-size: 16px;
$im-line-height-base: 1.6;

$im-spacing-unit: 1rem; // This is a SCSS variable often used in calculations
$im-content-padding-value: 1.25rem; // Direct value for CSS var
$im-section-padding-vertical-value: 3rem; // Direct value for CSS var

$im-navbar-height: 3.5rem;
$im-navbar-item-padding-v: 0.75rem;
$im-navbar-item-padding-h: 1rem;
$im-navbar-shadow: 0 1px 3px rgba(0,0,0,0.04);
$im-navbar-transition-duration: 0.3s;

$im-grid-line-width: 1px;
$im-grid-spacing: 40px;
$im-grid-fade-extent: 70%;
$im-grid-line-color-light: rgba(0, 0, 0, 0.035);
$im-grid-line-color-dark: rgba(255, 255, 255, 0.035);

$im-base-transition-duration: 0.2s;
$im-page-transition-duration: 0.2s;
$im-page-transition-translateY: 10px;

// For rgba() in CSS vars - SCSS variables holding just the RGB numbers
$im-primary-rgb-values: #{red($im-primary)}, #{green($im-primary)}, #{blue($im-primary)};
$im-border-rgb-values: #{red($im-border)}, #{green($im-border)}, #{blue($im-border)};
$im-text-rgb-values: #{red($im-text)}, #{green($im-text)}, #{blue($im-text)};
// Dark mode RGB values
$im-dark-surface-rgb-values: 30, 30, 30; // for #1e1e1e
$im-dark-background-rgb-values: 18, 18, 18; // for #121212
$im-dark-border-rgb-values: 50, 50, 50;   // for #323232 (example, adjust to match dark border color)


// =============================================================================
// 2. CSS CUSTOM PROPERTIES (:root - Light Mode & Dark Mode Definitions)
//    Initialized using the $im- SCSS variables defined above.
// =============================================================================
:root {
  // Colors
  --im-color-primary-rgb: #{$im-primary-rgb-values};
  --im-color-primary: #{$im-primary};
  --im-color-primary-light: #{$im-primary-light};
  --im-color-primary-dark: #{$im-primary-dark};
  --im-color-primary-inverse: #{$im-primary-inverse};

  --im-color-text: #{$im-text};
  --im-color-text-headings: #{$im-text-headings};
  --im-color-text-muted: #{$im-text-muted};
  --im-color-text-on-primary: var(--im-color-primary-inverse);
  --im-color-text-on-surface: var(--im-color-text);

  --im-color-background: #{$im-background};
  --im-color-surface: #{$im-surface};
  --im-navbar-bg-transparent: rgba(#{red($im-background)}, #{green($im-background)}, #{blue($im-background)}, 0.65);
  --im-navbar-bg-scrolled: rgba(#{red($im-surface)}, #{green($im-surface)}, #{blue($im-surface)}, 0.92);
  --im-navbar-border-transparent: rgba(#{$im-border-rgb-values}, 0.0);
  --im-navbar-border-scrolled: rgba(#{$im-border-rgb-values}, 0.5);
  --im-color-surface-alt: #{$im-surface-alt};

  --im-color-border-rgb: #{$im-border-rgb-values};
  --im-color-border: #{$im-border};
  --im-color-border-light: #{$im-border-light};
  --im-color-border-hover: #{$im-border-hover};

  --im-color-link: var(--im-color-primary);
  --im-color-link-hover: var(--im-color-primary-dark);

  --im-button-light-bg: #{mix($im-primary, $im-surface, 10%)};
  --im-button-light-border: var(--im-button-light-bg);
  --im-button-light-text: #{$im-primary-dark};
  --im-button-light-hover-bg: #{mix($im-primary, $im-surface, 20%)};
  --im-button-light-hover-border: var(--im-button-light-hover-bg);

  --im-input-bg: var(--im-color-surface);
  --im-input-border: var(--im-color-border);
  --im-input-text: var(--im-color-text);
  --im-input-placeholder-text: var(--im-color-text-muted);
  --im-input-focus-border: var(--im-color-primary);
  --im-input-focus-shadow: rgba(var(--im-color-primary-rgb), 0.25);

  // Sizing & Spacing
  --im-border-radius: #{$im-radius};
  --im-border-radius-large: #{$im-radius-large};
  --im-spacing-unit: #{$im-spacing-unit}; // Expose SCSS unit as CSS var
  --im-content-padding: #{$im-content-padding-value};
  --im-section-padding-vertical: #{$im-section-padding-vertical-value};
  --im-navbar-height: #{$im-navbar-height};
  --im-navbar-scroll-transition-duration: #{$im-navbar-transition-duration};
  --im-base-transition-duration: #{$im-base-transition-duration};
  --im-page-transition-duration-css: #{$im-page-transition-duration};

  // Fonts
  --im-font-family-sans-serif: #{$im-font-family-sans-serif};
  --im-font-family-monospace: #{$im-font-family-monospace};

  // Icons
  --im-icon-color: var(--im-color-text-muted);
  --im-icon-color-hover: var(--im-color-primary);

  // Site Background Grid
  --im-site-grid-line-color: #{$im-grid-line-color-light};
  --im-site-grid-spacing: #{$im-grid-spacing};
  --im-site-grid-line-width: #{$im-grid-line-width};

  // Component Grid Utilities Colors
  --im-color-grid-lines-default: rgba(var(--im-color-border-rgb), 0.3);
  --im-color-grid-lines-section: rgba(#{$im-text-rgb-values}, 0.05);
  --im-color-grid-lines-primary: rgba(var(--im-color-primary-rgb), 0.15);
  --im-color-grid-lines-light: rgba(var(--im-color-border-rgb), 0.2); // Lighter than default
  --im-color-grid-lines-dark: rgba(#{$im-text-rgb-values}, 0.08);   // Darker than section
}

html.im-is-dark-mode {
  --im-color-primary-inverse: #121212;
  --im-color-text: #e0e0e0;
  --im-color-text-headings: #f5f5f5;
  --im-color-text-muted: #a0a0a0;
  --im-color-background: #121212;
  --im-color-surface: #1e1e1e;
  --im-navbar-bg-transparent: rgba(#{$im-dark-background-rgb-values}, 0.65);
  --im-navbar-bg-scrolled: rgba(#{$im-dark-surface-rgb-values}, 0.92);
  --im-navbar-border-transparent: rgba(#{$im-dark-border-rgb-values}, 0.0);
  --im-navbar-border-scrolled: rgba(#{$im-dark-border-rgb-values}, 0.7);
  --im-color-surface-alt: #282828;
  --im-color-border-rgb: #{$im-dark-border-rgb-values};
  --im-color-border: rgb(var(--im-color-border-rgb));
  --im-color-border-light: #3a3a3a;
  --im-color-border-hover: #484848;
  --im-color-link: var(--im-color-primary-light);
  --im-color-link-hover: var(--im-color-primary);
  --im-button-light-bg: #333333;
  --im-button-light-border: #454545;
  --im-button-light-text: var(--im-color-text-headings);
  --im-button-light-hover-bg: #404040;
  --im-button-light-hover-border: #505050;
  --im-input-bg: var(--im-color-surface-alt);
  --im-input-border: var(--im-color-border);
  --im-input-text: var(--im-color-text);
  --im-input-placeholder-text: var(--im-color-text-muted);
  --im-input-focus-shadow: rgba(var(--im-color-primary-rgb), 0.35);
  --im-icon-color: var(--im-color-text-muted);
  --im-icon-color-hover: var(--im-color-primary-light);
  --im-site-grid-line-color: #{$im-grid-line-color-dark};
  --im-color-grid-lines-default: rgba(var(--im-color-border-rgb), 0.3);
  --im-color-grid-lines-section: rgba(255, 255, 255, 0.04);
  --im-color-grid-lines-primary: rgba(var(--im-color-primary-rgb), 0.2);
}


// =============================================================================
// 2. BULMA GLOBAL VARIABLE OVERRIDES
//    Using the $im- SCSS variables defined in Section 1.
// =============================================================================
$family-sans-serif: $im-font-family-sans-serif; // Corrected from primary-stack
$family-monospace: $im-font-family-monospace; // Corrected from monospace-stack

$primary: $im-primary; // Corrected from value
$primary-invert: $im-primary-inverse; // Corrected from value
// $primary-light: $im-primary-light; // Optional
// $primary-dark: $im-primary-dark;   // Optional

$link: $im-link-color; // Corrected
$link-hover: $im-link-hover-color; // Corrected

$text: $im-text; // Corrected from value
$text-light: $im-text-muted; // Corrected from value
$text-strong: $im-text-headings; // Corrected from value

$body-background-color: $im-background; // Corrected from value
$background: $im-background; // Corrected from value

$border: $im-border; // Corrected from value
$border-light: $im-border-light; // Corrected from value
$border-hover: $im-border-hover; // Corrected from value

$radius: $im-border-radius; // Corrected from value
$radius-small: calc(#{$im-border-radius} * 0.75);
$radius-large: $im-border-radius-large; // Corrected from value

$size-normal: $im-base-font-size; // Corrected - this was a key error source

$box-background-color: $im-surface; // Corrected
$box-radius: $radius-large;
$box-shadow: 0 4px 12px rgba(0,0,0,0.05), 0 1px 3px rgba(0,0,0,0.04);
$box-padding: 1.25rem; // Or use $im-content-padding if defined as SCSS var

$card-background-color: $im-surface; // Corrected
$card-radius: $radius-large;
$card-shadow: 0 5px 15px rgba(0,0,0,0.06), 0 1px 4px rgba(0,0,0,0.05);
$card-header-background-color: transparent;
$card-footer-border-top: 1px solid $border-light;

$input-background-color: $im-surface; // Corrected
$input-border-color: $border;
$input-color: $text;
$input-placeholder-color: $text-light;
$input-hover-border-color: $border-hover;
$input-focus-border-color: $primary;
$input-focus-box-shadow-size: 0 0 0 0.125em;
$input-focus-box-shadow-color: rgba($primary, 0.25);
$input-radius: $radius;

$navbar-background-color: transparent; // Initial compile-time, CSS vars will take over
$navbar-height: $im-navbar-height; // Corrected
$navbar-item-color: $text;
$navbar-item-hover-color: $link;
$navbar-item-hover-background-color: transparent;
$navbar-item-active-color: $link;
$navbar-item-active-background-color: transparent;
$navbar-dropdown-background-color: $im-surface; // Corrected
$navbar-dropdown-border-top: 1px solid $border-light;
$navbar-dropdown-item-hover-color: $link;
$navbar-dropdown-item-hover-background-color: $im-surface-alt; // Corrected
$navbar-dropdown-radius: $radius;
$navbar-dropdown-shadow: 0 6px 12px rgba(10,10,10,0.08);


// =============================================================================
// 3. IMPORT BULMA FRAMEWORK
// =============================================================================
@import "../node_modules/bulma/sass/index"; // Adjust path if necessary


// =============================================================================
// 4. BASE & HTML ELEMENT STYLES (Using CSS Custom Properties)
// =============================================================================
html {
  background-color: var(--im-color-background);
  /* font-size set by Bulma via $size-normal */
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: var(--im-font-family-sans-serif);
  color: var(--im-color-text);
  line-height: 1.6; /* From $im-line-height-base */
  background-color: transparent; /* html has the background color */
  min-height: 100vh;
  font-size: 1rem; /* Relative to html font-size */
  position: relative;
  overflow-x: hidden;
}

/* Site-wide Background Grid */
body::before {
  content: '';
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background-image:
    repeating-linear-gradient( to right, var(--im-site-grid-line-color) 0,
      var(--im-site-grid-line-color) var(--im-site-grid-line-width),
      transparent var(--im-site-grid-line-width),
      transparent var(--im-site-grid-spacing) ),
    repeating-linear-gradient( to bottom, var(--im-site-grid-line-color) 0,
      var(--im-site-grid-line-color) var(--im-site-grid-line-width),
      transparent var(--im-site-grid-line-width),
      transparent var(--im-site-grid-spacing) );
  background-size: var(--im-site-grid-spacing) var(--im-site-grid-spacing);
  background-position: center center;
  z-index: -10; pointer-events: none; opacity: 0.7;
}

/* Typography */
.title, .subtitle, h1, h2, h3, h4, h5, h6 { /* Consolidate font-family */
  font-family: var(--im-font-family-sans-serif);
  word-break: break-word;
}
.title {
  color: var(--im-color-text-headings) !important;
  font-weight: 600 !important; /* Bulma $weight-semibold or your $im-font-weight-bold */
  line-height: 1.125 !important; /* Bulma default */
}
.subtitle {
  color: var(--im-color-text-muted) !important;
  font-weight: 400 !important; /* Bulma $weight-normal */
  line-height: 1.25 !important; /* Bulma default */
}
p { margin-bottom: var(--im-spacing-unit); } /* Use CSS Var */
a:not(.button):not(.navbar-item):not(.dropdown-item):not(.panel-block):not(.tag) {
  color: var(--im-color-link);
  text-decoration: none;
  font-weight: 500;
  transition: color var(--im-base-transition-duration) ease;
  &:hover { color: var(--im-color-link-hover); }
}
strong { color: var(--im-color-text-headings); font-weight: 600; } /* Bulma $weight-semibold */
hr { background-color: var(--im-color-border); border: none; height: 1px; margin: 1.5rem 0;}

.im-main-content-area {
    padding-top: var(--im-navbar-height);
    transition: padding-top var(--im-navbar-scroll-transition-duration) ease-out;
}

// =============================================================================
// 5. LAYOUT COMPONENT STYLES
// =============================================================================
.section {
  padding: var(--im-section-padding-vertical) 1.5rem;
  position: relative;
  // Section-specific grid can be applied using .im-has-grid utility
}
.hero.is-primary {
  background-color: var(--im-color-primary);
  color: var(--im-color-primary-inverse);
  .title, .subtitle { color: var(--im-color-primary-inverse) !important; }
  .button.is-light { /* ... styles ... */ }
}
.hero .hero-body { padding: var(--im-section-padding-vertical) 1.5rem; }
.footer {
  background-color: var(--im-color-surface-alt); color: var(--im-color-text-muted);
  padding: 2rem 1.5rem; border-top: 1px solid var(--im-color-border); font-size: 0.9rem;
  a { color: var(--im-color-text); font-weight: 500; &:hover { color: var(--im-color-link-hover); } }
}

// =============================================================================
// 6. ELEMENT STYLES (Button, Box, Content, Icon, Image, Tag, Table)
// =============================================================================
.button {
  font-family: var(--im-font-family-sans-serif);
  font-weight: 500; /* Bulma $weight-medium */
  border-radius: var(--im-border-radius);
  transition: all var(--im-base-transition-duration) ease;
  box-shadow: 0 1px 2px rgba(0,0,0,0.03);
  &:active { transform: translateY(1px); box-shadow: none; }
}
/* .is-primary and .is-light for buttons are themed by Bulma vars */

.box {
  background-color: var(--im-color-surface);
  border-radius: var(--im-border-radius-large); /* Use CSS var */
  box-shadow: 0 4px 12px rgba(0,0,0,0.05), 0 1px 3px rgba(0,0,0,0.04); /* From Bulma vars */
  border: 1px solid var(--im-color-border-light);
  padding: var(--im-content-padding);
  color: var(--im-color-text-on-surface);
}

.content {
  code {
    background-color: var(--im-color-surface-alt); border: 1px solid var(--im-color-border-light);
    color: var(--im-color-primary-dark); padding: 0.2em 0.4em; border-radius: var(--im-border-radius);
    font-size: 0.875em; font-family: var(--im-font-family-monospace);
  }
  pre {
    background-color: var(--im-color-surface-alt); border: 1px solid var(--im-color-border);
    border-radius: var(--im-border-radius); padding: 1em; overflow-x: auto;
    code { background-color: transparent; border: none; padding: 0; color: inherit; font-size: inherit;}
  }
  blockquote { /* ... */ } table { /* ... */ }
}

.icon {
  color: var(--im-icon-color);
  i.ph { vertical-align: -0.15em; font-size: 1.05em; }
  a:hover > &.icon, button:hover > &.icon,
  a:hover > .icon-text > &.icon, button:hover > .icon-text > &.icon {
    color: var(--im-icon-color-hover);
  }
}
.icon-text { color: var(--im-color-text); &:hover { color: var(--im-color-link-hover); } }

figure.image img { border-radius: var(--im-border-radius); }
.tag {
  border-radius: var(--im-border-radius); font-weight: 500;
  &.is-light { background-color: var(--im-button-light-bg); color: var(--im-button-light-text); }
}

// =============================================================================
// 7. COMPONENT COLLECTION STYLES (Card, Dropdown, Navbar, Panel)
// =============================================================================
.card {
  border: 1px solid var(--im-color-border);
  /* background, radius, shadow from Bulma vars */
  .card-header { border-bottom: 1px solid var(--im-color-border-light); }
  .card-content { padding: var(--im-content-padding); }
  .card-footer { border-top: 1px solid var(--im-color-border-light); }
}

.dropdown-menu { /* ... */ } .dropdown-item, a.dropdown-item { /* ... */ } .dropdown-divider { /* ... */ }

.navbar.im-navbar-custom {
  min-height: var(--im-navbar-height) !important;
  background-color: var(--im-navbar-bg-transparent) !important;
  backdrop-filter: blur(10px) saturate(180%);
  -webkit-backdrop-filter: blur(10px) saturate(180%);
  border-bottom: 1px solid var(--im-navbar-border-transparent);
  transition: transform var(--im-navbar-scroll-transition-duration) ease-out,
              background-color var(--im-navbar-scroll-transition-duration) ease-out,
              border-color var(--im-navbar-scroll-transition-duration) ease-out,
              box-shadow var(--im-navbar-scroll-transition-duration) ease-out;
  /* position fixed, top, left, right, z-index from .is-fixed-top Bulma class */

  &.is-visible {
    transform: translateY(0%);
    background-color: var(--im-navbar-bg-scrolled) !important;
    border-bottom-color: var(--im-navbar-border-scrolled);
    box-shadow: $im-navbar-shadow; // Use SCSS var for consistency
  }
  &.is-hidden-scroll { transform: translateY(-100%); }

  .navbar-brand { min-height: var(--im-navbar-height); }
  .navbar-brand .navbar-item { padding-top:0; padding-bottom:0; display:flex; align-items:center; }

  .navbar-menu {
    @media screen and (max-width: 1023px) { /* Bulma $desktop - 1px */
      &.is-active {
        background-color: var(--im-color-surface);
        box-shadow: 0 8px 16px rgba(10,10,10,0.12);
        padding: 0.5rem 0;
        border-radius: 0 0 var(--im-border-radius) var(--im-border-radius);
        border: 1px solid var(--im-color-border); border-top: none;
        position: absolute; left: 0; right: 0; top: 100%; z-index: 20;
      }
    }
  }
  .navbar-item, .navbar-link {
    color: var(--im-color-text) !important;
    font-weight: 500 !important; /* Use SCSS var $im-font-weight-medium */
    padding: $im-navbar-item-padding-v $im-navbar-item-padding-h !important; /* Use SCSS vars */
    min-height: var(--im-navbar-height);
    display: flex; align-items: center; position: relative;
    transition: color var(--im-base-transition-duration) ease;
    .icon i.ph { transition: color var(--im-base-transition-duration) ease; }

    &:hover, &.is-hovered {
      background-color: transparent !important;
      color: var(--im-color-primary) !important;
      .icon i.ph { color: var(--im-color-primary) !important; }
    }
    &.is-active-nav-item {
      color: var(--im-color-primary) !important;
      font-weight: 600 !important; /* Use SCSS var $im-font-weight-semibold */
      background-color: transparent !important;
      .icon i.ph { color: var(--im-color-primary) !important; }
      &::after { /* Triangle */
        content: ''; position: absolute; bottom: 4px; left: 50%; transform: translateX(-50%);
        width: 0; height: 0; border-left: 5px solid transparent;
        border-right: 5px solid transparent; border-bottom: 5px solid var(--im-color-primary);
      }
    }
  }
  .navbar-link::after { /* Dropdown arrow */
    border-color: var(--im-color-text-muted) !important;
    right: $im-navbar-item-padding-h * 0.7;
  }
  .navbar-link:hover::after, .navbar-link.is-active-nav-item::after {
    border-color: var(--im-color-primary) !important;
  }
  .navbar-dropdown {
    /* Styles from previous responses, ensure CSS vars are used */
    background-color: var(--im-color-surface) !important;
    border: 1px solid var(--im-color-border) !important; /* ...etc... */
  }
  .im-logo-link .im-logo-image { /* ... */ } .im-logo-link .im-logo-text { /* ... */ }
  .im-nav-icon { /* ... */ } .im-nav-image-icon { /* ... */ }
  .navbar-brand .navbar-item.is-hidden-desktop { margin-left:auto; }
  .im-navbar-mobile-action .icon i.ph, .im-dark-mode-toggle .icon i.ph {
    color: var(--im-icon-color);
    &:hover { color: var(--im-icon-color-hover); }
  }
}
html.im-is-dark-mode .navbar.im-navbar-custom { /* ... dark mode specific navbar tweaks ... */ }

.panel { /* ... from previous ... */ }

// =============================================================================
// 8. FORM ELEMENT STYLES
// =============================================================================
.input, .textarea, .select select { /* ... from previous, using CSS vars ... */ }
.label { /* ... */ } .help { /* ... */ }

// =============================================================================
// 9. UTILITY STYLES (Background Grid classes)
// =============================================================================
// --- Component Grid Utilities ---
// This section contains the .im-has-grid and its modifier classes
// from the previous _grid.scss example, ensuring they use CSS variables.
// All $im-grid-* SCSS variables should be from Section 1.
// The ::before pseudo-element will use var(--current-grid-*) which are set by modifiers.
.im-has-grid {
  position: relative; z-index: 0;
}
.im-has-grid::before {
  content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  width: 100%; height: 100%; z-index: -1; pointer-events: none; border-radius: inherit;
  --current-grid-spacing: var(--im-grid-spacing-val, #{$im-grid-spacing}); /* Use SCSS var as fallback */
  --current-grid-line-width: #{$im-grid-line-width};
  --current-grid-fade-extent: var(--im-grid-fade-val, #{$im-grid-fade-extent});
  --current-grid-line-color: var(--im-color-grid-lines-default); /* Default from CSS vars */
  background-image: /* ... gradients using var(--current-grid-*) ... */;
  background-size: var(--current-grid-spacing) var(--current-grid-spacing);
  background-position: center center;
  mask-image: radial-gradient(ellipse at center, black 0%, black var(--current-grid-fade-extent), transparent 100%);
  -webkit-mask-image: radial-gradient(ellipse at center, black 0%, black var(--current-grid-fade-extent), transparent 100%);
}
.im-has-grid.is-grid-tiny::before    { --im-grid-spacing-val: 10px; }
.im-has-grid.is-grid-small::before   { --im-grid-spacing-val: 15px; }
.im-has-grid.is-grid-large::before   { --im-grid-spacing-val: 45px; }
.im-has-grid.is-grid-primary::before { --current-grid-line-color: var(--im-color-grid-lines-primary); }
/* ... other grid modifiers ... */


// =============================================================================
// 10. PAGE TRANSITION ANIMATIONS
// =============================================================================
body.im-page-is-loading { opacity: 1; }
body.im-page-is-entering { opacity: 1; }
body.im-page-is-exiting {
  animation: imPageFadeOutDown $im-page-transition-duration forwards ease-in !important;
}
@keyframes imPageFadeOutDown {
  from { opacity: 1; transform: translateY(0); }
  to   { opacity: 0; transform: translateY($im-page-transition-translateY); }
}

// =============================================================================
// 11. DARK MODE SPECIFIC COMPONENT ADJUSTMENTS (Minimal)
// =============================================================================
html.im-is-dark-mode {
    /* Paste specific dark mode overrides from previous full example here */
    /* e.g., .box, .card shadows, .navbar specific adjustments */
}