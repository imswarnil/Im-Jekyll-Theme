// main.scss
---
# Jekyll front matter to process this file (ensures Jekyll processes it)
---

// =============================================================================
// MAIN.SCSS - "IM" THEME FOR BULMA (Enji.dev Inspired - Single File)
// =============================================================================
// This single file defines theme values, overrides Bulma variables,
// imports Bulma, and then applies additional custom styling.
// All SCSS variables are defined first, then CSS Custom Properties,
// then Bulma variable overrides, then Bulma import, then custom CSS.
// =============================================================================

// =============================================================================
// 1. CORE "IM" THEME SCSS VARIABLES (Raw Values for Bulma Overrides)
// =============================================================================
$im-font-family-sans-serif: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif; // Ensure no stray characters
$im-font-family-monospace: "Roboto Mono", Consolas, Monaco, monospace;

$im-font-weight-normal: 400;
$im-font-weight-medium: 500;
$im-font-weight-semibold: 600;
$im-font-weight-bold: 700; // Enji.dev uses bold headings

// --- Colors ---
// Your primary red
$im-primary: #e53935;
$im-primary-light: #ef5350;
$im-primary-dark: #c62828;
$im-primary-inverse: #FFFFFF;

// Base text and background colors for light mode (Enji.dev inspired)
$im-text: #2d3748; // A common dark grey for text (like Tailwind's gray-800)
$im-text-headings: #1a202c; // Slightly darker for headings (like Tailwind's gray-900)
$im-text-muted: #718096; // For subtitles, meta (like Tailwind's gray-500)
$im-background: #f7fafc; // Very light grey (like Tailwind's gray-100)
$im-surface: #FFFFFF;   // For cards, boxes
$im-surface-alt: #edf2f7; // Slightly darker surface (like Tailwind's gray-200)
$im-border: #e2e8f0;     // Default border (like Tailwind's gray-300)
$im-border-light: #f1f5f9; // Lighter border (like Tailwind's gray-200)
$im-border-hover: #cbd5e0; // (like Tailwind's gray-400)

// --- Sizing & Spacing ---
$im-base-font-size: 16px; // Standard
$im-line-height-base: 1.65; // Good for readability

$im-border-radius: 6px; // Subtle rounded corners
$im-border-radius-large: 8px; // For larger elements like cards

$im-spacing-unit: 1rem; // Base for margins/paddings

// Navbar specific
$im-navbar-height: 3.75rem; // Slightly taller for a more modern feel
$im-navbar-item-padding-v: 0.75rem;
$im-navbar-item-padding-h: 1rem;
$im-navbar-shadow: 0 2px 4px rgba(0,0,0,0.03); // Very subtle shadow
$im-navbar-transition-duration: 0.3s;

// Site-wide Background Grid
$im-grid-line-width: 1px;
$im-grid-spacing: 35px; // Slightly adjusted
$im-grid-line-color-light: rgba(0, 0, 0, 0.03); // Even more subtle
$im-grid-line-color-dark: rgba(255, 255, 255, 0.03);

// Transitions
$im-base-transition-duration: 0.25s; // Slightly smoother default
$im-page-transition-duration: 0.2s;
$im-page-transition-translateY: 10px;


// =============================================================================
// 2. CSS CUSTOM PROPERTIES (:root - Light Mode & Dark Mode Definitions)
// =============================================================================
:root {
  // --- Colors ---
  --im-color-primary-rgb: #{red($im-primary)}, #{green($im-primary)}, #{blue($im-primary)};
  --im-color-primary: #{$im-primary};
  --im-color-primary-light: #{$im-primary-light};
  --im-color-primary-dark: #{$im-primary-dark};
  --im-color-primary-inverse: #{$im-primary-inverse};

  --im-color-text: #{$im-text};
  --im-color-text-headings: #{$im-text-headings};
  --im-color-text-muted: #{$im-text-muted};
  --im-color-text-on-primary: var(--im-color-primary-inverse);
  --im-color-text-on-surface: var(--im-color-text);

  --im-color-background: #{$im-background};
  --im-color-surface: #{$im-surface};
  --im-navbar-bg-transparent: rgba(#{red($im-background)}, #{green($im-background)}, #{blue($im-background)}, 0.75); // More blur, less tint
  --im-navbar-bg-scrolled: rgba(#{red($im-surface)}, #{green($im-surface)}, #{blue($im-surface)}, 0.95);
  --im-navbar-border-transparent: rgba(#{red($im-border)}, #{green($im-border)}, #{blue($im-border)}, 0.0);
  --im-navbar-border-scrolled: rgba(#{red($im-border)}, #{green($im-border)}, #{blue($im-border)}, 0.3); // Softer scrolled border
  --im-color-surface-alt: #{$im-surface-alt};

  --im-color-border-rgb: #{red($im-border)}, #{green($im-border)}, #{blue($im-border)};
  --im-color-border: #{$im-border};
  --im-color-border-light: #{$im-border-light};
  --im-color-border-hover: #{$im-border-hover};

  --im-color-link: var(--im-color-primary);
  --im-color-link-hover: var(--im-color-primary-dark);

  --im-button-light-bg: #{mix($im-primary, $im-surface, 8%)}; // Even lighter tint
  --im-button-light-border: var(--im-button-light-bg);
  --im-button-light-text: #{$im-primary-dark};
  --im-button-light-hover-bg: #{mix($im-primary, $im-surface, 15%)};
  --im-button-light-hover-border: var(--im-button-light-hover-bg);

  --im-input-bg: var(--im-color-surface);
  --im-input-border: var(--im-color-border);
  --im-input-text: var(--im-color-text);
  --im-input-placeholder-text: var(--im-color-text-muted);
  --im-input-focus-border: var(--im-color-primary);
  --im-input-focus-shadow: rgba(var(--im-color-primary-rgb), 0.2); // Softer focus shadow

  // Sizing & Spacing
  --im-border-radius: #{$im-border-radius};
  --im-border-radius-large: #{$im-border-radius-large};
  --im-spacing-unit: #{$im-spacing-unit};
  --im-content-padding: calc(var(--im-spacing-unit) * 1.5); // Standardized padding
  --im-section-padding-vertical: calc(var(--im-spacing-unit) * 3.5); // Generous section padding
  --im-navbar-height: #{$im-navbar-height};
  --im-navbar-scroll-transition-duration: #{$im-navbar-transition-duration};
  --im-base-transition-duration: #{$im-base-transition-duration};
  --im-page-transition-duration-css: #{$im-page-transition-duration};

  // Fonts
  --im-font-family-sans-serif: #{$im-font-family-sans-serif};
  --im-font-family-monospace: #{$im-font-family-monospace};

  // Icons
  --im-icon-color: var(--im-color-text-muted);
  --im-icon-color-hover: var(--im-color-primary);

  // Site Background Grid
  --im-site-grid-line-color: #{$im-grid-line-color-light};
  --im-site-grid-spacing: #{$im-grid-spacing};
  --im-site-grid-line-width: #{$im-grid-line-width};

  // Component Grid Utilities Colors
  --im-color-grid-lines-default: rgba(var(--im-color-border-rgb), 0.2); // More subtle component grid
  --im-color-grid-lines-primary: rgba(var(--im-color-primary-rgb), 0.1);
}

// Dark Mode CSS Variables (Enji.dev often has a prominent dark theme)
html.im-is-dark-mode {
  --im-color-primary-inverse: #101112; // Very dark text on primary
  --im-color-text: #c1c9d4; // Lighter grey
  --im-color-text-headings: #e5e7eb; // Off-white for headings
  --im-color-text-muted: #9ca3af; // Mid-grey
  --im-color-background: #0c0d0e; // Very dark, almost black
  --im-color-surface: #16181a;   // Dark grey for cards
  --im-navbar-bg-transparent: rgba(12, 13, 14, 0.75); // Dark transparent
  --im-navbar-bg-scrolled: rgba(22, 24, 26, 0.95);   // Slightly less transparent dark
  --im-navbar-border-transparent: rgba(55, 65, 81, 0.0); // Dark border RGB
  --im-navbar-border-scrolled: rgba(55, 65, 81, 0.4);
  --im-color-surface-alt: #202327; // Slightly lighter dark surface

  --im-color-border-rgb: 55, 65, 81; // Tailwind gray-700
  --im-color-border: rgb(var(--im-color-border-rgb));
  --im-color-border-light: #4b5563; // Tailwind gray-600
  --im-color-border-hover: #6b7280; // Tailwind gray-500

  --im-color-link: var(--im-color-primary-light);
  --im-color-link-hover: #{$im-primary-light}; // Use the SCSS var for slight brighten

  --im-button-light-bg: #374151; // Tailwind gray-700
  --im-button-light-border: #4b5563; // Tailwind gray-600
  --im-button-light-text: var(--im-color-text-headings);
  --im-button-light-hover-bg: #4b5563;
  --im-button-light-hover-border: #6b7280;

  --im-input-bg: #{$im-surface-alt}; // Darker input bg
  --im-input-border: var(--im-color-border);
  --im-input-text: var(--im-color-text);
  --im-input-placeholder-text: var(--im-color-text-muted);
  --im-input-focus-shadow: rgba(var(--im-color-primary-rgb), 0.3);

  --im-icon-color: var(--im-color-text-muted);
  --im-icon-color-hover: var(--im-color-primary-light);

  --im-site-grid-line-color: #{$im-grid-line-color-dark};
  --im-color-grid-lines-default: rgba(var(--im-color-border-rgb), 0.2);
  --im-color-grid-lines-primary: rgba(var(--im-color-primary-rgb), 0.15);
}


// =============================================================================
// 3. BULMA GLOBAL VARIABLE OVERRIDES
//    Using the $im- SCSS variables defined in Section 1.
// =============================================================================
$family-sans-serif: $im-font-family-sans-serif;
$family-monospace: $im-font-family-monospace;

$primary: $im-primary;
$primary-invert: $im-primary-inverse;
// Let Bulma derive light/dark variants of primary

$link: $im-link-color; // Use our SCSS var for Bulma's link color
$link-hover: $im-link-hover-color; // Use our SCSS var

$text: $im-text;
$text-light: $im-text-muted; // For Bulma's .has-text-grey-light etc.
$text-strong: $im-text-headings;

$body-background-color: $im-background;
$background: $im-background; // General background for some components

$border: $im-border;
$border-light: $im-border-light; // Used by card footers etc.
$border-hover: $im-border-hover; // Used by inputs

$radius: $im-border-radius;
$radius-small: calc(#{$im-border-radius} * 0.75);
$radius-large: $im-border-radius-large;

$size-normal: $im-base-font-size; // Bulma's 1rem base

// Component specific variables
$box-background-color: $im-surface;
$box-radius: $radius-large;
$box-shadow: 0 3px 6px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.03); // Softer shadow
$box-padding: 1.5rem; // Default Bulma, override with CSS var for IM theme

$card-background-color: $im-surface;
$card-radius: $radius-large;
$card-shadow: 0 4px 8px rgba(0,0,0,0.05), 0 2px 4px rgba(0,0,0,0.04);
$card-header-background-color: transparent; // Clean look
$card-header-padding: 1rem 1.25rem;
$card-content-padding: 1.25rem;
$card-footer-border-top: 1px solid $border-light;
$card-footer-padding: 1rem 1.25rem;

$input-background-color: $im-surface;
$input-border-color: $border;
$input-color: $text;
$input-placeholder-color: $text-light;
$input-hover-border-color: $border-hover;
$input-focus-border-color: $primary;
$input-focus-box-shadow-size: 0 0 0 0.125em;
$input-focus-box-shadow-color: rgba($primary, 0.2); // Softer focus shadow
$input-radius: $radius;
$input-shadow: none; // Flatter inputs

$navbar-background-color: transparent; // Base for SCSS, CSS vars handle dynamic
$navbar-height: $im-navbar-height;
$navbar-item-color: $text;
$navbar-item-hover-color: $link;
$navbar-item-hover-background-color: transparent;
$navbar-item-active-color: $link;
$navbar-item-active-background-color: transparent;
$navbar-dropdown-background-color: $im-surface;
$navbar-dropdown-border-top: 1px solid $border-light; // Or none if connected
$navbar-dropdown-item-hover-color: $link;
$navbar-dropdown-item-hover-background-color: $im-surface-alt;
$navbar-dropdown-radius: $radius;
$navbar-dropdown-shadow: 0 5px 10px rgba(10,10,10,0.07); // Softer dropdown shadow

$section-padding: 3rem 1.5rem; // Bulma's default, override with CSS var

$footer-background-color: $im-surface-alt;
$footer-color: $im-text-muted;
$footer-padding: 2rem 1.5rem; // Slightly less padding

// Add any other Bulma global vars you want to tie to your $im- theme


// =============================================================================
// 3. IMPORT BULMA FRAMEWORK
// =============================================================================
@import "../node_modules/bulma/sass/index"; // Ensure this path is correct


// =============================================================================
// 4. BASE & HTML ELEMENT STYLES (Using CSS Custom Properties)
// =============================================================================
html {
  background-color: var(--im-color-background);
  /* font-size set by Bulma via $size-normal which uses $im-base-font-size */
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: var(--im-font-family-sans-serif);
  color: var(--im-color-text);
  line-height: $im-line-height-base; /* Use SCSS var for base line-height */
  background-color: transparent; /* html has the background color */
  min-height: 100vh;
  font-size: 1rem; /* Ensures rem units are based on html font-size */
  position: relative; /* For background grid pseudo-element */
  overflow-x: hidden; /* Prevent horizontal scroll from grid */
}

/* Fixed Background Grid for the entire site */
body::before {
  content: '';
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background-image:
    repeating-linear-gradient( to right, var(--im-site-grid-line-color) 0,
      var(--im-site-grid-line-color) var(--im-site-grid-line-width),
      transparent var(--im-site-grid-line-width),
      transparent var(--im-site-grid-spacing) ),
    repeating-linear-gradient( to bottom, var(--im-site-grid-line-color) 0,
      var(--im-site-grid-line-color) var(--im-site-grid-line-width),
      transparent var(--im-site-grid-line-width),
      transparent var(--im-site-grid-spacing) );
  background-size: var(--im-site-grid-spacing) var(--im-site-grid-spacing);
  background-position: center center; /* Or 0 0 for top-left alignment */
  z-index: -10; /* Deepest background layer */
  pointer-events: none;
  opacity: 0.6; /* Further subtle adjustment */
}

/* Typography */
.title, .subtitle, h1, h2, h3, h4, h5, h6 {
  font-family: var(--im-font-family-sans-serif);
  word-break: break-word; /* Prevent overflow */
}
.title {
  color: var(--im-color-text-headings) !important;
  font-weight: $im-font-weight-bold !important; /* Use SCSS var */
  line-height: 1.15 !important; /* Tighter for headings */
}
.subtitle {
  color: var(--im-color-text-muted) !important;
  font-weight: $im-font-weight-normal !important; /* Use SCSS var */
  line-height: 1.4 !important;
}
p { margin-bottom: var(--im-spacing-unit); }
a:not(.button):not(.navbar-item):not(.dropdown-item):not(.panel-block):not(.tag):not(.card-footer-item) { // Be very specific
  color: var(--im-color-link);
  text-decoration: none;
  font-weight: $im-font-weight-medium; /* Use SCSS var */
  transition: color var(--im-base-transition-duration) ease;
  &:hover { color: var(--im-color-link-hover); }
}
strong { color: var(--im-color-text-headings); font-weight: $im-font-weight-semibold; } /* Use SCSS var */
hr { background-color: var(--im-color-border); border: none; height: 1px; margin: 1.5rem 0;}

.im-main-content-area {
    padding-top: var(--im-navbar-height);
    transition: padding-top var(--im-navbar-scroll-transition-duration) ease-out;
}


// =============================================================================
// 5. LAYOUT COMPONENT STYLES
// =============================================================================
.section {
  padding: var(--im-section-padding-vertical) 1.5rem;
  position: relative;
}
/* Grid lines are on body. If specific sections need their own grid or NO grid,
   use the .im-has-grid utility or a .im-no-grid class */

.hero.is-primary {
  background-color: var(--im-color-primary);
  color: var(--im-color-primary-inverse);
  .title, .subtitle { color: var(--im-color-primary-inverse) !important; }
  .button.is-light {
    background-color: var(--im-color-primary-inverse) !important;
    border-color: var(--im-color-primary-inverse) !important;
    color: var(--im-color-primary) !important;
    &:hover { background-color: rgba(255,255,255,0.95) !important; border-color: rgba(255,255,255,0.95) !important; }
  }
}
.hero .hero-body { padding: var(--im-section-padding-vertical) 1.5rem; }

.footer {
  background-color: var(--im-color-surface-alt);
  color: var(--im-color-text-muted);
  padding: var(--im-section-padding-vertical) 1.5rem; /* Consistent padding */
  border-top: 1px solid var(--im-color-border);
  font-size: 0.9rem;
  a { color: var(--im-color-text); font-weight: $im-font-weight-medium;
    &:hover { color: var(--im-color-link-hover); }
  }
}


// =============================================================================
// 6. ELEMENT STYLES (Button, Box, Content, Icon, etc.)
// =============================================================================
.button {
  font-family: var(--im-font-family-sans-serif);
  font-weight: $im-font-weight-medium; /* Use SCSS var */
  border-radius: var(--im-border-radius);
  transition: all var(--im-base-transition-duration) ease;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04); /* Softer */
  // Bulma handles padding based on size. is-primary, is-light use themed variables.
  &:active { transform: translateY(1px); box-shadow: none; }
}

.box {
  background-color: var(--im-color-surface);
  border-radius: var(--im-border-radius-large);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); /* Enji-like soft shadow */
  border: 1px solid var(--im-color-border-light);
  padding: var(--im-content-padding);
  color: var(--im-color-text-on-surface);
}

.content {
  h1,h2,h3,h4,h5,h6 { margin-bottom:0.75em; font-weight: $im-font-weight-semibold; } /* Use SCSS var */
  code { /* ... same as before ... */ }
  pre { /* ... same as before ... */ }
  blockquote { /* ... same as before ... */ }
  table { /* ... same as before ... */ }
}

.icon {
  color: var(--im-icon-color);
  i.ph { vertical-align: -0.15em; font-size: 1.05em; } /* Phosphor specific */
  a:hover > &.icon, button:hover > &.icon,
  a:hover > .icon-text > &.icon, button:hover > .icon-text > &.icon {
    color: var(--im-icon-color-hover);
  }
}
.icon-text { color: var(--im-color-text); &:hover { color: var(--im-color-link-hover); } }

figure.image img { border-radius: var(--im-border-radius); }

.tag {
  border-radius: var(--im-border-radius);
  font-weight: $im-font-weight-medium;
  // .is-primary and .is-light are themed by Bulma variables
}
// .notification, .progress, .table additional overrides here if needed


// =============================================================================
// 7. COMPONENT COLLECTION STYLES (Card, Dropdown, Navbar, Panel)
// =============================================================================
.card {
  background-color: var(--im-color-surface);
  border-radius: var(--im-border-radius-large);
  box-shadow: 0 6px 18px rgba(0,0,0,0.06); /* Slightly more pronounced than box */
  border: 1px solid var(--im-color-border);
  .card-header {
    border-bottom: 1px solid var(--im-color-border-light);
    padding: 0.75rem var(--im-content-padding);
    .card-header-title { font-weight: $im-font-weight-semibold; } /* Use SCSS var */
  }
  .card-content { padding: var(--im-content-padding); }
  .card-footer { border-top: 1px solid var(--im-color-border-light); padding: 0.75rem var(--im-content-padding); }
}

.dropdown-menu {
  background-color: var(--im-color-surface); border: 1px solid var(--im-color-border);
  border-radius: var(--im-border-radius); box-shadow: 0 5px 15px rgba(0,0,0,0.1); /* Slightly more shadow */
  padding-top: 0.3rem; padding-bottom: 0.3rem;
}
.dropdown-item, a.dropdown-item {
  color: var(--im-color-text); padding: 0.6rem 1.1rem; font-size: 0.9rem; /* Slightly adjusted */
  &:hover { background-color: var(--im-color-surface-alt); color: var(--im-color-primary); }
  &.is-active { background-color: var(--im-color-primary); color: var(--im-color-primary-inverse); }
}
.dropdown-divider { background-color: var(--im-color-border-light); }

// --- NAVBAR ---
.navbar.im-navbar-custom { /* Using custom class for overrides */
  min-height: var(--im-navbar-height) !important;
  background-color: var(--im-navbar-bg-transparent) !important;
  backdrop-filter: blur(12px) saturate(180%); /* More blur */
  -webkit-backdrop-filter: blur(12px) saturate(180%);
  border-bottom: 1px solid var(--im-navbar-border-transparent);
  transition: transform var(--im-navbar-scroll-transition-duration) ease-out,
              background-color var(--im-navbar-scroll-transition-duration) ease-out,
              border-color var(--im-navbar-scroll-transition-duration) ease-out,
              box-shadow var(--im-navbar-scroll-transition-duration) ease-out;
  position: fixed; top: 0; left: 0; right: 0; z-index: 1030; // Standard fixed nav z-index

  &.is-visible { /* JS toggled */
    transform: translateY(0%);
    background-color: var(--im-navbar-bg-scrolled) !important;
    border-bottom-color: var(--im-navbar-border-scrolled);
    box-shadow: $im-navbar-shadow; /* Use SCSS var */
  }
  &.is-hidden-scroll { transform: translateY(-100%); } /* JS toggled */

  .navbar-brand { min-height: var(--im-navbar-height); }
  .navbar-brand .navbar-item { padding-top:0; padding-bottom:0; display:flex; align-items:center; }

  .navbar-menu {
    @media screen and (max-width: 1023px) { /* Bulma $desktop - 1px */
      &.is-active {
        background-color: var(--im-color-surface);
        box-shadow: 0 8px 16px rgba(0,0,0,0.15); /* Enhanced shadow for open menu */
        padding: 0.5rem 0;
        border-radius: 0 0 var(--im-border-radius) var(--im-border-radius);
        border: 1px solid var(--im-color-border); border-top: none;
        position: absolute; left: 0; right: 0; top: 100%; z-index: 20;
      }
    }
  }
  .navbar-item, .navbar-link {
    color: var(--im-color-text) !important;
    font-weight: $im-font-weight-medium !important; /* Use SCSS var */
    padding: $im-navbar-item-padding-v $im-navbar-item-padding-h !important; /* Use SCSS vars */
    min-height: var(--im-navbar-height);
    display: flex; align-items: center; position: relative;
    transition: color var(--im-base-transition-duration) ease;
    .icon i.ph { transition: color var(--im-base-transition-duration) ease; }

    &:hover, &.is-hovered {
      background-color: transparent !important; color: var(--im-color-primary) !important;
      .icon i.ph { color: var(--im-color-primary) !important; }
    }
    &.is-active-nav-item {
      color: var(--im-color-primary) !important; font-weight: $im-font-weight-semibold !important; /* Use SCSS var */
      background-color: transparent !important;
      .icon i.ph { color: var(--im-color-primary) !important; }
      &::after { /* Triangle */
        content: ''; position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%);
        width: 0; height: 0; border-left: 6px solid transparent;
        border-right: 6px solid transparent; border-bottom: 6px solid var(--im-color-primary);
      }
    }
  }
  .navbar-link::after { /* Dropdown arrow */
    border-color: var(--im-color-text-muted) !important;
    right: $im-navbar-item-padding-h * 0.75; /* Adjusted for padding */
  }
  .navbar-link:hover::after, .navbar-link.is-active-nav-item::after {
    border-color: var(--im-color-primary) !important;
  }
  .navbar-dropdown {
    background-color: var(--im-color-surface) !important; border: 1px solid var(--im-color-border) !important;
    border-top: none !important; border-radius: 0 0 var(--im-border-radius) var(--im-border-radius) !important;
    box-shadow: 0 8px 20px rgba(0,0,0,0.1) !important; /* Slightly larger dropdown shadow */
    padding-top: 0.3rem !important; padding-bottom: 0.3rem !important; font-size: 0.9rem;
    .navbar-item {
      padding: 0.6rem 1.2rem !important; min-height: auto; color: var(--im-color-text) !important;
      &:hover { background-color: var(--im-color-surface-alt) !important; color: var(--im-color-primary) !important;}
      &.is-active-nav-item {
        background-color: rgba(var(--im-color-primary-rgb), 0.08) !important;
        color: var(--im-color-primary-dark) !important; font-weight: $im-font-weight-medium !important;
        &::after { display: none; }
      }
    }
  }
  .im-logo-link .im-logo-image { max-height: calc(var(--im-navbar-height) * 0.6); margin-right: 0.6rem;}
  .im-logo-link .im-logo-text { font-size: 1.15rem; color: var(--im-color-text-headings); font-weight: $im-font-weight-bold;}
  .im-nav-icon { margin-right: 0.6em; i.ph { font-size: 1.2em; }}
  .im-nav-image-icon { max-height: 1.25rem; margin-right: 0.6em; &.is-small { max-height: 1rem; }}
  .navbar-brand .navbar-item.is-hidden-desktop { margin-left:auto; }
  .im-navbar-mobile-action .icon i.ph, .navbar-end .im-dark-mode-toggle .icon i.ph {
    color: var(--im-icon-color);
    &:hover { color: var(--im-icon-color-hover); }
  }
}

.panel { /* ... */ }

// =============================================================================
// 8. FORM ELEMENT STYLES
// =============================================================================
.input, .textarea, .select select {
  font-family: var(--im-font-family-sans-serif); border-radius: var(--im-border-radius);
  border: 1px solid var(--im-input-border); box-shadow: none;
  background-color: var(--im-input-bg); color: var(--im-input-text);
  transition: border-color var(--im-base-transition-duration) ease, box-shadow var(--im-base-transition-duration) ease;
  padding: 0.75em 1em; // Enji often has slightly more padded inputs

  &::placeholder { color: var(--im-input-placeholder-text); opacity: 0.7; }
  &:hover { border-color: var(--im-color-border-hover); }
  &:focus, &.is-focused, &:active, &.is-active {
    border-color: var(--im-input-focus-border) !important;
    box-shadow: 0 0 0 0.125em var(--im-input-focus-shadow) !important;
  }
}
.textarea { line-height: 1.65; }
.select:not(.is-multiple):not(.is-loading)::after { border-color: var(--im-color-primary); right: 1.2em; }
.label { color: var(--im-color-text-headings); font-weight: $im-font-weight-semibold; margin-bottom: 0.6em; }
.help { color: var(--im-color-text-muted); font-size: 0.9em; margin-top: 0.3em; }


// =============================================================================
// 9. UTILITY STYLES (Background Grid classes)
// =============================================================================
.im-has-grid { position: relative; z-index: 0; }
.im-has-grid::before {
  content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  width: 100%; height: 100%; z-index: -1; pointer-events: none; border-radius: inherit;
  --current-grid-spacing: var(--im-grid-spacing-val, #{$im-grid-spacing});
  --current-grid-line-width: #{$im-grid-line-width};
  --current-grid-fade-extent: var(--im-grid-fade-val, #{$im-grid-fade-extent});
  --current-grid-line-color: var(--im-color-grid-lines-default); // Use CSS var
  background-image:
    repeating-linear-gradient(to right, var(--current-grid-line-color) 0, var(--current-grid-line-color) var(--current-grid-line-width), transparent var(--current-grid-line-width), transparent var(--current-grid-spacing)),
    repeating-linear-gradient(to bottom, var(--current-grid-line-color) 0, var(--current-grid-line-color) var(--current-grid-line-width), transparent var(--current-grid-line-width), transparent var(--current-grid-spacing));
  background-size: var(--current-grid-spacing) var(--current-grid-spacing);
  background-position: center center;
  mask-image: radial-gradient(ellipse at center, black 0%, black var(--current-grid-fade-extent), transparent 100%);
  -webkit-mask-image: radial-gradient(ellipse at center, black 0%, black var(--current-grid-fade-extent), transparent 100%);
}
.im-has-grid.is-grid-tiny::before    { --im-grid-spacing-val: 10px; }
.im-has-grid.is-grid-small::before   { --im-grid-spacing-val: 15px; }
.im-has-grid.is-grid-large::before   { --im-grid-spacing-val: 45px; }
.im-has-grid.is-grid-primary::before { --current-grid-line-color: var(--im-color-grid-lines-primary); }
// ... other .is-grid-* modifiers from previous, using their respective CSS vars


// =============================================================================
// 10. PAGE TRANSITION ANIMATIONS
// =============================================================================
body.im-page-is-loading { opacity: 1; }
body.im-page-is-entering { opacity: 1; }
body.im-page-is-exiting {
  animation: imPageFadeOutDown $im-page-transition-duration forwards ease-in !important;
}
@keyframes imPageFadeOutDown {
  from { opacity: 1; transform: translateY(0); }
  to   { opacity: 0; transform: translateY($im-page-transition-translateY); }
}

// =============================================================================
// 11. DARK MODE SPECIFIC COMPONENT ADJUSTMENTS
// =============================================================================
html.im-is-dark-mode {
  // Most dark mode handled by CSS variables. Add specific overrides here if needed.
  .box { box-shadow: 0 4px 15px rgba(0,0,0,0.25), 0 1px 5px rgba(0,0,0,0.2); }
  .card { box-shadow: 0 5px 20px rgba(0,0,0,0.3), 0 1px 6px rgba(0,0,0,0.25); }
  .navbar.im-navbar-custom.is-visible { box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
  // etc.
}