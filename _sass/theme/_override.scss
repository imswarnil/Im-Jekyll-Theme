// _scss/theme/_overrides.scss

//-------------------------------------------------------------------
// 1. DEFINE CSS CUSTOM PROPERTIES (LIGHT MODE - DEFAULT)
// These are your theme's design tokens, populated by the static Sass variables.
//-------------------------------------------------------------------
:root {
  // Jekyll Themed Accent Color
  --jk-accent-color: #{$primary}; // From Bulma's $primary (which is $static-accent-color)
  --jk-accent-color-rgb: #{$static-accent-color-rgb};
  --jk-accent-foreground-color: #{$static-accent-foreground-color};

  // Fallbacks for dynamic CMS font variables
  --gh-font-heading: #{$fontFamilyHeadings};
  --gh-font-body: #{$fontFamilyBody};

  // Core Colors
  --color-contrast: #{$staticColorContrast};
  --color-background: #{$staticColorBackground};
  --color-background-100: #{$staticColorBackground100};
  --color-background-200: #{$staticColorBackground200};
  --color-background-300: #{$staticColorBackground300};
  --color-foreground: #{$staticColorForeground};
  --color-secondary: #{$staticColorSecondary};
  --color-mute: #{$staticColorMute};
  --color-border: #{$staticColorBorder};
  --color-success: #{$staticColorSuccess};
  --color-error: #{$staticColorError};
  --color-overlay: rgba(5, 5, 5, 0.7);

  // Font Families
  --font-family-headings: #{$fontFamilyHeadings};
  --font-family-body: #{$fontFamilyBody};
  --font-family-button: #{$fontFamilyButton};
  --font-family-mono: #{$fontFamilyMonospace};

  // Font Sizes
  --font-x-small: #{$size-7};
  --font-small: #{$size-6};
  --font-base: #{$size-5};
  --font-large: #{$size-4};

  // Font Weights
  --font-weight-light: #{$fontWeightLight};
  --font-weight-regular: #{$fontWeightRegular};
  --font-weight-medium: #{$fontWeightMedium};
  --font-weight-semibold: #{$fontWeightSemibold};
  --font-weight-bold: #{$fontWeightBold};

  // Spacings
  --spacing-1: 0.125rem; --spacing-2: 0.25rem;  --spacing-3: 0.375rem;
  --spacing-4: 0.5rem;   --spacing-5: 0.625rem; --spacing-6: 0.75rem;
  --spacing-7: 1rem;     --spacing-8: 1.25rem;  --spacing-9: 1.875rem;
  --spacing-10: 5rem;    --spacing-11: 6.25rem;
  --vertical-rhythm: 1.5rem;

  // Border Radius (reflecting sharp edges from Sass vars)
  --radius-1: #{$radius-small}; // 0px
  --radius-2: #{$radius};       // 0px
  --radius-3: #{$radius-large}; // 0px
  --radius-4: 0px; // Use 0px for these as well for consistency
  --radius-5: 0px;
  // --radius-6: clamp(0px, ...); // If you had a fluid sharp concept
  --radius-6: 0px;

  // Layout Padding (using clamp from theme for responsiveness)
  --layout--padding: clamp(16px, 1.0625rem + 1.25vw, 30px); // 11.25px from your example was likely a calc error
                                                            // Recalculated: (30-16)/(1500-380) = 14/1120 = 0.0125 -> 1.25vw
                                                            // Intercept: 16px - 380px * 0.0125 = 16 - 4.75 = 11.25px (this is the slope intercept)

  // Navbar
  --navbar--min-height: #{$navbar-height};

  // Button CSS vars (for custom elements, Bulma buttons use Sass vars primarily)
  --button--padding-v: var(--spacing-4);
  --button--padding-h: var(--spacing-8);
  --button--min-height: 2.5rem;
  --button--font-size: var(--font-small);
  --button--font-weight: var(--font-weight-medium);
  --button--line-height: 1.5;
  --button--border-radius: #{$button-radius}; // 20px
  --button--color: var(--jk-accent-foreground-color);
  --button--background-color: var(--jk-accent-color);
  --button-hover--color: var(--color-background);
  --button-hover--background-color: var(--color-contrast);
  --button-hover--opacity: 0.8;

  // Container Widths
  --container--width: #{$container-max-width};
  --container-wide--width: #{$widescreen};

  // Shadow (original theme shadow, for elements that *should* have it)
  --shadow: 0 20px 60px -10px hsla(0, 4%, 68%, 0.24),
            0 4px 20px -8px rgba(0, 0, 0, 0.24%);

  // Popup / Dropdown / Avatar specific theme vars
  --popup--overlay--background-color: #e8e8e8;
  --dropdown--background-color: var(--color-background);
  --avatar--size: 2.25rem;
  --avatar--background-color: var(--color-background-100);
  --avatar-hover--background-color: var(--color-background-200);
  --avatar--color: var(--color-secondary);

  color-scheme: light;
}

//-------------------------------------------------------------------
// 2. GLOBAL HTML & BODY STYLES
//-------------------------------------------------------------------
html {
  background-color: var(--color-background);
  font-size: $body-size;
}

body {
  font-family: var(--font-family-body);
  font-weight: var(--font-weight-regular);
  color: var(--color-foreground);
  background-color: var(--color-background);
  line-height: $body-line-height;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  padding: 0; // Remove any default browser padding on body
  margin: 0; // Remove any default browser margin on body
}

//-------------------------------------------------------------------
// 3. TYPOGRAPHY & CONTENT OVERRIDES
//-------------------------------------------------------------------
.title, .subtitle {
  font-family: var(--font-family-headings);
  color: var(--color-contrast);
}
.title {
  font-weight: var(--font-weight-semibold);
  // Bulma .is-N classes control size via Sass $size-N vars
}
.subtitle {
  color: var(--color-secondary);
  font-weight: var(--font-weight-regular);
}

a {
  color: var(--jk-accent-color); // Use your themed accent
  text-decoration: underline;
  text-decoration-color: currentColor; // Underline matches text color
  text-decoration-thickness: 0.075em;  // Theme specific
  text-underline-offset: 0.15em;     // Theme specific
  transition: color 0.1s ease, text-decoration-color 0.1s ease;

  &:hover {
    color: var(--jk-accent-color); // Or a distinct hover accent color
    text-decoration-color: transparent; // Theme hover hides underline
  }
}

// Content styling for general HTML elements within .content
.content {
  blockquote {
    border-left: 2px solid var(--jk-accent-color);
    color: var(--color-contrast);
    font-weight: var(--font-weight-medium);
    padding: var(--spacing-4) var(--spacing-7);
    background-color: transparent;
    margin-left: 0; margin-right: 0; // Override Bulma indent
    margin-top: var(--vertical-rhythm);
    margin-bottom: var(--vertical-rhythm);
  }

  pre {
    background-color: var(--color-background-100);
    border-radius: var(--radius-1); // Or 0 for sharp
    padding: var(--spacing-6) var(--spacing-7);
    border: 1px solid var(--color-border);
    box-shadow: none;
    color: var(--color-contrast);
    font-size: var(--font-small);
    font-family: var(--font-family-mono);
    overflow-x: auto;
    code {
      background-color: transparent !important;
      color: inherit !important;
      padding: 0 !important;
      font-size: inherit !important;
      border-radius: 0 !important;
      border: none !important;
      box-shadow: none !important;
    }
  }
  :not(pre) > code {
    background-color: var(--color-background-100);
    border-radius: var(--radius-1); // Or 0
    padding: var(--spacing-2) var(--spacing-3);
    border: 1px solid var(--color-border);
    box-shadow: none;
    color: var(--color-contrast);
    font-family: var(--font-family-mono);
    font-size: 0.875em; // Relative to parent
  }

  hr {
    background-color: var(--color-border);
    height: 1px;
    border: none;
    margin: var(--vertical-rhythm) 0;
  }

  // Lists matching theme's style (custom bullets)
  ul, ol {
    margin: var(--vertical-rhythm) 0;
    padding-left: 0; // Reset Bulma's padding
  }
  ul {
    list-style: none;
    li {
      padding-left: var(--spacing-8); // Indent for custom bullet
      position: relative;
      &::before {
        content: "";
        position: absolute;
        left: var(--spacing-2); // Position bullet within padding
        top: 0.65em; // Align with text
        height: 0.25rem; // Size of bullet
        width: 0.25rem;
        background-color: currentColor; // Or var(--color-secondary)
        border-radius: 50%;
      }
      ul li::before { // Nested ul bullet
         background-color: transparent;
         border: 1px solid currentColor; // Or var(--color-secondary)
      }
    }
  }
  ol {
    list-style: none; // If you want custom numbered markers, otherwise use 'decimal'
    counter-reset: orderedlist;
    li {
      padding-left: var(--spacing-8);
      position: relative;
      &::before {
        content: counter(orderedlist) ". ";
        counter-increment: orderedlist;
        position: absolute;
        left: 0; // Adjust as needed
        color: var(--color-secondary);
        font-weight: var(--font-weight-medium);
      }
    }
  }
  li + li {
    margin-top: var(--spacing-4); // Space between list items
  }
}


//-------------------------------------------------------------------
// 4. BULMA COMPONENT SPECIFIC STYLING
//-------------------------------------------------------------------

.button {
  font-family: var(--font-family-button);
  font-weight: var(--font-weight-semibold); // Theme override
  // Sizes and padding are from Bulma $button-* vars
  border-radius: var(--button--border-radius); // Should be 20px from theme calc
  line-height: var(--button--line-height);
  transition: var(--button--transition, background-color 0.15s ease);
  min-height: var(--button--min-height); // Ensure min height from theme
  border-width: 0; // Theme buttons appear borderless

  &.is-primary {
    background-color: var(--button--background-color); // --jk-accent-color
    color: var(--button--color); // --jk-accent-foreground-color
    &:hover, &:focus {
      background-color: var(--button-hover--background-color);
      color: var(--button-hover--color);
      opacity: var(--button-hover--opacity, 0.8);
    }
  }
  &.is-light {
    background-color: var(--color-background-100);
    color: var(--color-contrast);
    border: 1px solid var(--color-border); // Add border to light buttons
    &:hover, &:focus {
      background-color: var(--color-background-200);
      border-color: var(--color-border); // Or a hover border color
    }
  }
}

// Cards and Boxes: Enforce NO SHADOW, LIGHT BORDER, NO RADIUS
.card, .box {
  border-radius: 0 !important;
  box-shadow: none !important;
  border: 1px solid var(--color-border) !important;
  background-color: var(--color-background);
}

.card {
  .card-header {
    background-color: transparent;
    box-shadow: none;
    border-bottom: 1px solid var(--color-border);
    border-radius: 0 !important;
    padding: var(--spacing-6) var(--spacing-7);
    .card-header-title {
      color: var(--color-contrast);
      font-family: var(--font-family-headings);
      font-weight: var(--font-weight-semibold);
      padding: 0;
    }
  }
  .card-image img { border-radius: 0 !important; }
  .card-content { padding: var(--spacing-7); }
  .card-footer {
    border-top: 1px solid var(--color-border);
    background-color: transparent;
    padding: 0;
    .card-footer-item {
      padding: var(--spacing-6) var(--spacing-7);
      color: var(--jk-accent-color);
      border-right: 1px solid var(--color-border);
      &:last-child { border-right: none; }
      &:hover {
        color: var(--jk-accent-color); // Or darken($staticJkAccentColor, 10%)
        background-color: var(--color-background-100);
      }
    }
  }
}

.box { padding: var(--spacing-8); } // Using --spacing-8 as per theme

.navbar {
  min-height: var(--navbar--min-height);
  background-color: transparent; // Relies on :before
  box-shadow: none;
  border-bottom: 1px solid var(--color-border); // Add bottom border
  &:before {
    content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-color: var(--color-background);
    opacity: 0.98; // Theme-like opacity
    z-index: -1;
  }
  // Navbar item styling from Bulma Sass variables is generally good.
  // Override specific aspects if needed:
  .navbar-item, .navbar-link {
    font-family: var(--font-family-button);
    font-size: var(--font-small);
    font-weight: var(--font-weight-medium);
    color: var(--color-foreground);
    padding-top: var(--spacing-4); // Match --button--padding-v
    padding-bottom: var(--spacing-4);
    &:hover, &.is-active {
      background-color: var(--color-background-100);
      color: var(--jk-accent-color);
    }
  }
  .navbar-dropdown {
    background-color: var(--dropdown--background-color);
    border: 1px solid var(--color-border);
    border-top: none; // Usually connected
    border-radius: 0 0 var(--radius-2) var(--radius-2); // Rounded bottom corners
    box-shadow: var(--shadow);
  }
}

// Forms
.input, .textarea, .select select {
  background-color: var(--color-background-100);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-1); // Or 0px if fully sharp
  color: var(--color-contrast);
  min-height: var(--button--min-height); // Match button height for consistency
  padding: var(--button--padding-v) var(--button--padding-h); // Use button padding
  font-size: var(--font-small);
  font-weight: var(--font-weight-medium);

  &:hover { border-color: var(--color-border); } // No change or use a defined hover border
  &:focus, &.is-focused, &:active, &.is-active {
    border-color: var(--jk-accent-color);
    box-shadow: 0 0 0 0.125em rgba(var(--jk-accent-color-rgb), 0.25);
  }
  &::placeholder { color: var(--color-mute); }
}
label.label {
  color: var(--color-contrast);
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--spacing-4);
  font-size: var(--font-small);
}

// Pagination to match button style
.pagination {
  .pagination-link, .pagination-previous, .pagination-next {
    font-family: var(--font-family-button);
    font-weight: var(--font-weight-medium);
    font-size: var(--font-small);
    min-width: var(--button--min-height);
    height: var(--button--min-height);
    padding-left: var(--button--padding-h);
    padding-right: var(--button--padding-h);
    border-radius: var(--button--border-radius); // Match button roundness
    border: 1px solid var(--color-border);
    color: var(--color-foreground);
    background-color: var(--color-background);

    &:hover {
      border-color: var(--jk-accent-color);
      color: var(--jk-accent-color);
      background-color: var(--color-background-100);
    }
    &.is-current {
      background-color: var(--jk-accent-color);
      border-color: var(--jk-accent-color);
      color: var(--jk-accent-foreground-color);
    }
    &:disabled {
      background-color: var(--color-background-100);
      border-color: var(--color-border);
      color: var(--color-mute);
      opacity: 0.7;
    }
  }
  .pagination-ellipsis {
    color: var(--color-mute);
    border: 1px solid transparent;
    min-width: var(--button--min-height);
    height: var(--button--min-height);
    padding-left: var(--button--padding-h);
    padding-right: var(--button--padding-h);
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
}

// Your Archive Page Specific Styles
// Should largely inherit from .card/.box and .content overrides now
.archive-column-cards {
  .post-item-box { // This is a .box or .card
    .content {
      .level-item .tag {
        font-weight: var(--font-weight-medium); // Make tags slightly bolder
        // Colors are set by Bulma's .is-warning, .is-info etc.
        // and the .is-light modifier.
      }
      .message.is-light { // For TLDR
         background-color: var(--color-background-100);
         border-radius: var(--radius-1); // Or 0
         border: 1px solid var(--color-border);
         border-left-width: 3px;
         &.is-warning { border-left-color: $warning; } // Use Bulma SASS var here
         &.is-info { border-left-color: $info; }
         .message-body {
            padding: var(--spacing-4) var(--spacing-6);
            color: var(--color-foreground);
         }
      }
    }
    .post-item-footer {
      .tags .tag.is-light {
        background-color: var(--color-background-100);
        color: var(--color-secondary);
        border-radius: var(--radius-rounded); // Fully rounded tags
      }
      .buttons .button { // Demo/Code buttons in footer
        &.is-light { // Ensure these also have the desired border
          border: 1px solid var(--color-border);
        }
      }
    }
  }
}