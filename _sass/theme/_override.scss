// _scss/theme/_overrides.scss

//-------------------------------------------------------------------
// A. MIXINS (Example)
//-------------------------------------------------------------------
@mixin sharp-bordered-container {
  border-radius: 0 !important;
  box-shadow: none !important;
  border: 1px solid var(--color-border) !important;
  background-color: var(--color-background);
}

//-------------------------------------------------------------------
// B. CSS CUSTOM PROPERTIES (LIGHT MODE - DEFAULT)
// Using values from _variables.scss (our $theme-* constants)
//-------------------------------------------------------------------
:root {
  // Jekyll Themed Accent Color
  --jk-accent-color: #{$theme-jk-accent-color};
  --jk-accent-color-rgb: #{$theme-jk-accent-color-rgb};
  --jk-accent-foreground-color: #{$theme-jk-accent-foreground-color};

  // Ghost specific vars (fallbacks)
  --gh-font-heading: #{$theme-font-family-headings};
  --gh-font-body: #{$theme-font-family-main};
  --ghost-accent-color: var(--jk-accent-color);

  // Core Colors
  --color-contrast: #{$theme-color-contrast};
  --color-background: #{$theme-color-background};
  --color-background-100: #{$theme-color-background-100};
  --color-background-200: #{$theme-color-background-200};
  --color-background-300: #{$theme-color-background-300};
  --color-foreground: #{$theme-color-foreground};
  --color-secondary: #{$theme-color-secondary};
  --color-mute: #{$theme-color-mute};
  --color-border: #{$theme-color-border};
  --color-success: #{$theme-color-success};
  --color-error: #{$theme-color-error};
  --color-overlay: rgba(5, 5, 5, 0.7);

  // Font Families
  --font-family-headings: #{$theme-font-family-headings};
  --font-family-body: #{$theme-font-family-main};
  --font-family-button: #{$theme-font-family-buttons};
  --font-family-mono: #{$theme-font-family-mono};

  // Font Sizes
  --font-x-small: #{$theme-font-size-xsmall};
  --font-small: #{$theme-font-size-small};
  --font-base: #{$theme-font-size-base};
  --font-large: #{$theme-font-size-large};
  // Additional theme heading sizes if needed directly as CSS vars
  --font-size-h1: #{$theme-font-size-h1};
  --font-size-h2: #{$theme-font-size-h2};
  --font-size-h3: #{$theme-font-size-h3};


  // Font Weights
  --font-weight-light: #{$theme-font-weight-light};
  --font-weight-regular: #{$theme-font-weight-regular};
  --font-weight-medium: #{$theme-font-weight-medium};
  --font-weight-semibold: #{$theme-font-weight-semibold};
  --font-weight-bold: #{$theme-font-weight-bold};

  // Spacings
  --spacing-1: 0.125rem; --spacing-2: 0.25rem;  --spacing-3: 0.375rem;
  --spacing-4: 0.5rem;   --spacing-5: 0.625rem; --spacing-6: 0.75rem;
  --spacing-7: 1rem;     --spacing-8: 1.25rem;  --spacing-9: 1.875rem;
  --spacing-10: 5rem;    --spacing-11: 6.25rem;
  --vertical-rhythm: 1.5rem;

  // Border Radius
  --radius-1: #{$theme-radius-small}; // 6px for elements that *do* get rounded
  --radius-2: #{$theme-radius-default}; // 8px
  --radius-3: #{$theme-radius-large}; // 10px
  --radius-4: 0px; // Was 14px in theme, now sharp
  --radius-5: 0px; // Was 16px in theme, now sharp
  --radius-6: clamp(0px, calc(11.25px + 1.25vw - 16px * 0.0125 * 380 / 1px), 0px); // Or simply 0px
  --radius-sharp: 0px; // For explicit sharp edges

  // Layout
  --layout--padding: clamp(16px, calc(11.25px + 1.25vw), 30px);

  // Navbar
  --navbar--min-height: #{$navbar-height};

  // Button
  --button--padding-v: var(--spacing-4);
  --button--padding-h: var(--spacing-8);
  --button--min-height: 2.5rem;
  --button--font-size: var(--font-small);
  --button--font-weight: var(--font-weight-medium);
  --button--line-height: 1.5;
  --button--border-radius: #{$theme-button-radius}; // 20px
  --button--color: var(--jk-accent-foreground-color);
  --button--background-color: var(--jk-accent-color);
  --button--opacity: 1;
  --button--transition: clip-path 0.2s ease, background-color 0.1s ease,
		border-color 0.1s ease, color 0.1s ease, opacity 0.1s ease;
  --button-hover--color: var(--color-background);
  --button-hover--background-color: var(--color-contrast);
  --button-hover--opacity: 0.8;

  // Container
  --container--width: #{$container-max-width};
  --container-wide--width: #{$widescreen};

  // Featured image
  --featured-image--max-width: #{$fullhd}; // Assuming this maps

  // Popup / Dropdown / Avatar
  --popup--overlay--background-color: #e8e8e8;
  --dropdown--background-color: var(--color-background);
  --avatar--size: 2.25rem;
  --avatar--font-size: var(--font-small);
  --avatar--color: var(--color-secondary);
  --avatar--background-color: var(--color-background-100);
  --avatar-hover--background-color: var(--color-background-200);

  // Shadow (Use --shadow-themed for original, --shadow-none for no shadow)
  --shadow-themed: #{$theme-shadow-default};
  --shadow-none: none;
  --shadow: var(--shadow-none); // Default to no shadow for elements like card/box

  color-scheme: light;
}

//-------------------------------------------------------------------
// C. GLOBAL HTML & BODY STYLES (Using CSS Custom Properties)
//-------------------------------------------------------------------
html {
  background-color: var(--color-background);
  font-size: $body-size; // Sass variable for root font size
}

body {
  font-family: var(--font-family-body);
  font-weight: var(--font-weight-regular);
  color: var(--color-foreground);
  background-color: var(--color-background);
  line-height: $body-line-height; // Sass variable
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

//-------------------------------------------------------------------
// D. TYPOGRAPHY & CONTENT OVERRIDES (Using CSS Custom Properties)
//-------------------------------------------------------------------
.title, .subtitle {
  font-family: var(--font-family-headings);
  color: var(--color-contrast);
}
.title {
  font-weight: var(--font-weight-semibold);
  // Sizes are set by Bulma .is-N classes using $size-N Sass vars
  // Example override for H1 to exactly match theme if Bulma's .is-1 isn't precise enough
  &.is-1 { font-size: var(--font-size-h1, 1.75rem); line-height: 1.1; }
}
.subtitle {
  color: var(--color-secondary);
  font-weight: var(--font-weight-regular);
}

a {
  color: var(--jk-accent-color);
  text-decoration: underline;
  text-decoration-color: currentColor;
  text-decoration-thickness: 0.075em;
  text-underline-offset: 0.15em;
  transition: var(--button--transition); // Use button's transition for links too

  &:hover {
    color: var(--jk-accent-color);
    text-decoration-color: transparent;
  }
}

.content { // Styles for content generated from Markdown, etc.
  blockquote {
    border-left: 2px solid var(--jk-accent-color);
    color: var(--color-contrast);
    font-weight: var(--font-weight-medium);
    padding: var(--spacing-4) var(--spacing-7);
    background-color: transparent;
    margin: var(--vertical-rhythm) 0 var(--vertical-rhythm) 0; // No Bulma indent
  }

  pre {
    background-color: var(--color-background-100);
    border-radius: var(--radius-1); // Use theme radius or --radius-sharp
    padding: var(--spacing-6) var(--spacing-7);
    border: 1px solid var(--color-border);
    box-shadow: var(--shadow-none); // Explicitly no shadow
    color: var(--color-contrast);
    font-size: var(--font-small);
    font-family: var(--font-family-mono);
    overflow-x: auto;
    margin: var(--vertical-rhythm) 0;
    code {
      background: none !important; color: inherit !important; padding: 0 !important;
      font-size: inherit !important; border-radius: 0 !important; border: none !important;
      box-shadow: none !important;
    }
  }
  :not(pre) > code {
    background-color: var(--color-background-100);
    border-radius: var(--radius-1);
    padding: var(--spacing-2) var(--spacing-3);
    border: 1px solid var(--color-border);
    box-shadow: var(--shadow-none);
    color: var(--color-contrast);
    font-family: var(--font-family-mono);
    font-size: inherit; // Take size from parent, then apply 0.875em if needed
  }

  hr {
    background-color: var(--color-border); height: 1px; border: none;
    margin: var(--vertical-rhythm) 0;
  }
}

//-------------------------------------------------------------------
// E. BULMA COMPONENT OVERRIDES (Using CSS Custom Properties)
//-------------------------------------------------------------------

.button {
  font-family: var(--font-family-button);
  font-size: var(--button--font-size);
  font-weight: var(--font-weight-semibold); // Theme wants semibold
  min-height: var(--button--min-height);
  line-height: var(--button--line-height);
  padding: var(--button--padding-v) var(--button--padding-h);
  border-radius: var(--button--border-radius); // 20px
  border-width: 0;
  transition: var(--button--transition);
  color: var(--button--color);
  background-color: var(--button--background-color);
  opacity: var(--button--opacity);

  &:hover, &:focus {
    color: var(--button-hover--color);
    background-color: var(--button-hover--background-color);
    opacity: var(--button-hover--opacity);
  }
  &.is-light {
    background-color: var(--color-background-100);
    color: var(--color-contrast);
    border: 1px solid var(--color-border); // Give light buttons a border
    &:hover, &:focus {
      background-color: var(--color-background-200);
      border-color: var(--color-border); // Or a slightly darker static color
    }
  }
}

.card, .box {
  @include sharp-bordered-container; // Using the mixin
  // Additional specific styles if needed that the mixin doesn't cover
}

.card {
  .card-header {
    background-color: transparent;
    box-shadow: none;
    border-bottom: 1px solid var(--color-border);
    border-radius: 0 !important; // Ensure header part is also sharp
    padding: var(--spacing-6) var(--spacing-7);
    .card-header-title {
      color: var(--color-contrast);
      font-family: var(--font-family-headings);
      font-weight: var(--font-weight-semibold);
      padding: 0; // Reset Bulma padding
    }
  }
  .card-image img { border-radius: 0 !important; }
  .card-content { padding: var(--spacing-7); }
  .card-footer {
    border-top: 1px solid var(--color-border);
    background-color: transparent;
    padding: 0;
    .card-footer-item {
      padding: var(--spacing-6) var(--spacing-7);
      color: var(--jk-accent-color);
      border-right: 1px solid var(--color-border);
      &:last-child { border-right: none; }
      &:hover {
        background-color: var(--color-background-100);
      }
    }
  }
}

.box { padding: var(--spacing-8); }

.navbar {
  min-height: var(--navbar--min-height);
  background-color: transparent;
  box-shadow: none;
  border-bottom: 1px solid var(--color-border);
  &::before { // The overlay effect
    content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-color: var(--color-background);
    opacity: 0.95;
    z-index: -1;
    backdrop-filter: blur(8px); // If desired
  }
  .navbar-item, .navbar-link {
    color: var(--color-foreground);
    font-family: var(--font-family-button);
    font-size: var(--font-small);
    font-weight: var(--font-weight-medium);
    padding: var(--spacing-4) var(--spacing-6); // Theme padding
    &:hover, &.is-active {
      background-color: var(--color-background-100);
      color: var(--jk-accent-color);
    }
  }
  .navbar-dropdown {
    background-color: var(--dropdown--background-color);
    border: 1px solid var(--color-border);
    border-top: none;
    border-radius: 0 0 var(--radius-2) var(--radius-2); // Use theme radius (which is 0px if $radius is 0)
    box-shadow: var(--shadow-themed); // Use themed shadow for dropdowns
  }
}

.input, .textarea, .select select {
  background-color: var(--color-background-100);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-1); // Or specific input radius from theme like 1.5rem
  color: var(--color-contrast);
  min-height: 3rem; // From theme form specs
  padding: var(--spacing-6) var(--spacing-8); // From theme form specs
  font-size: var(--font-small);
  font-weight: var(--font-weight-medium);
  box-shadow: none; // No default input shadow

  &:hover { border-color: var(--color-border); }
  &:focus, &.is-focused, &:active, &.is-active {
    border-color: var(--jk-accent-color);
    box-shadow: 0 0 0 0.125em rgba(var(--jk-accent-color-rgb), 0.25);
  }
  &::placeholder { color: var(--color-mute); }
}
label.label { // Bulma .label
  color: var(--color-contrast);
  font-weight: var(--font-weight-medium); // Theme
  margin-bottom: var(--spacing-4);
  font-size: var(--font-small);
}


// Archive Page Specific Styles
.archive-column-cards {
  .post-item-box { // This is a .box or .card
    // Uses @include sharp-bordered-container;
    .content {
      .message.is-light {
         background-color: var(--color-background-100);
         border-radius: var(--radius-1);
         border: 1px solid var(--color-border);
         border-left-width: 3px;
         // Use Bulma's color classes to handle the left border and text color
         // e.g., <article class="message is-light is-warning">
         &.is-warning { border-left-color: $warning; } // Sass var here is fine as it's a static color
         &.is-info   { border-left-color: $info; }
         .message-body {
            padding: var(--spacing-4) var(--spacing-6);
            color: var(--color-foreground);
         }
      }
    }
    .post-item-footer .buttons .button.is-light {
        border: 1px solid var(--color-border); // Ensure footer light buttons also get border
    }
  }
}