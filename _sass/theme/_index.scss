/* theme-overrides.css */

/* ==========================================================================
   1. CSS CUSTOM PROPERTIES (:root - Light Mode & Dark Mode Definitions)
   ========================================================================== */
:root {
  /* --- Colors --- */
  --im-color-primary-rgb: 229, 57, 53; /* Your Red */
  --im-color-primary: rgb(var(--im-color-primary-rgb));
  --im-color-primary-light: #ef5350;
  --im-color-primary-dark: #c62828;
  --im-color-primary-inverse: #FFFFFF;

  /* Text Colors - Light Mode */
  --im-color-text: #2d3748;
  --im-color-text-headings: #1a202c;
  --im-color-text-muted: #718096;
  --im-color-text-on-primary: #FFFFFF;
  --im-color-text-on-surface: var(--im-color-text);

  /* Backgrounds & Surfaces - Light Mode */
  --im-color-background: #f7fafc; /* Matches $body-background-color */
  --im-color-surface: #FFFFFF;
  --im-navbar-bg-transparent: rgba(247, 250, 252, 0.75); /* Based on background */
  --im-navbar-bg-scrolled: rgba(255, 255, 255, 0.95);
  --im-navbar-border-transparent: rgba(226, 232, 240, 0.0); /* Based on border */
  --im-navbar-border-scrolled: rgba(226, 232, 240, 0.4);
  --im-color-surface-alt: #edf2f7;

  /* Borders - Light Mode */
  --im-color-border-rgb: 226, 232, 240;
  --im-color-border: rgb(var(--im-color-border-rgb));
  --im-color-border-light: #f1f5f9;
  --im-color-border-hover: #cbd5e0;

  /* Links */
  --im-color-link: var(--im-color-primary); /* Uses primary */
  --im-color-link-hover: var(--im-color-primary-dark);

  /* Buttons - Light Variant (Primary is handled by Bulma's $primary) */
  --im-button-light-bg: #fef2f2; /* Light red tint */
  --im-button-light-border: #fde8e8;
  --im-button-light-text: var(--im-color-primary-dark);
  --im-button-light-hover-bg: #fee2e2;
  --im-button-light-hover-border: #fdd8d8;

  /* Inputs */
  --im-input-bg: var(--im-color-surface);
  --im-input-border: var(--im-color-border);
  --im-input-text: var(--im-color-text);
  --im-input-placeholder-text: var(--im-color-text-muted);
  --im-input-focus-border: var(--im-color-primary);
  --im-input-focus-shadow: rgba(var(--im-color-primary-rgb), 0.2);

  /* --- Sizing & Spacing --- */
  --im-border-radius: 4px;
  --im-border-radius-large: 6px;
  --im-spacing-unit: 1rem;
  --im-content-padding: 1.5rem;
  --im-section-padding-vertical: 3.5rem;
  --im-navbar-height: 3.75rem;
  --im-navbar-scroll-transition-duration: 0.3s;
  --im-base-transition-duration: 0.25s;

  /* --- Fonts --- */
  --im-font-family-sans-serif: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  --im-font-family-monospace: "Roboto Mono", Consolas, Monaco, monospace;

  /* --- Icons --- */
  --im-icon-color: var(--im-color-text-muted);
  --im-icon-color-hover: var(--im-color-primary);

  /* --- Site Background Grid --- */
  --im-site-grid-line-color: rgba(0, 0, 0, 0.03);
  --im-site-grid-spacing: 35px;
  --im-site-grid-line-width: 1px;
}

html.im-is-dark-mode {
  --im-color-primary-inverse: #101112;
  --im-color-text: #c1c9d4;
  --im-color-text-headings: #e5e7eb;
  --im-color-text-muted: #9ca3af;
  --im-color-background: #0c0d0e;
  --im-color-surface: #16181a;
  --im-navbar-bg-transparent: rgba(12, 13, 14, 0.75);
  --im-navbar-bg-scrolled: rgba(22, 24, 26, 0.95);
  --im-navbar-border-transparent: rgba(55, 65, 81, 0.0);
  --im-navbar-border-scrolled: rgba(55, 65, 81, 0.4);
  --im-color-surface-alt: #202327;
  --im-color-border-rgb: 55, 65, 81;
  --im-color-border: rgb(var(--im-color-border-rgb));
  --im-color-border-light: #4b5563;
  --im-color-border-hover: #6b7280;
  --im-color-link: var(--im-color-primary-light);
  --im-color-link-hover: var(--im-color-primary); /* Keep primary for hover in dark */
  --im-button-light-bg: #374151;
  --im-button-light-border: #4b5563;
  --im-button-light-text: var(--im-color-text-headings);
  --im-button-light-hover-bg: #4b5563;
  --im-button-light-hover-border: #6b7280;
  --im-input-bg: var(--im-color-surface-alt);
  --im-input-border: var(--im-color-border);
  --im-input-text: var(--im-color-text);
  --im-input-placeholder-text: var(--im-color-text-muted);
  --im-input-focus-shadow: rgba(var(--im-color-primary-rgb), 0.3);
  --im-icon-color: var(--im-color-text-muted);
  --im-icon-color-hover: var(--im-color-primary-light);
  --im-site-grid-line-color: rgba(255, 255, 255, 0.03);
}

/* ==========================================================================
   2. BASE & HTML ELEMENT STYLES
   ========================================================================== */
html {
  background-color: var(--im-color-background);
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: var(--im-font-family-sans-serif);
  color: var(--im-color-text);
  line-height: 1.65; /* Enji.dev often has generous line height */
  background-color: transparent; /* Let html background show through, grid is on body::before */
  min-height: 100vh;
  font-size: 1rem; /* Relative to html font-size (Bulma default) */
  position: relative;
  overflow-x: hidden;
}

/* Site-wide Background Grid */
body::before {
  content: '';
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background-image:
    repeating-linear-gradient( to right, var(--im-site-grid-line-color) 0,
      var(--im-site-grid-line-color) var(--im-site-grid-line-width),
      transparent var(--im-site-grid-line-width),
      transparent var(--im-site-grid-spacing) ),
    repeating-linear-gradient( to bottom, var(--im-site-grid-line-color) 0,
      var(--im-site-grid-line-color) var(--im-site-grid-line-width),
      transparent var(--im-site-grid-line-width),
      transparent var(--im-site-grid-spacing) );
  background-size: var(--im-site-grid-spacing) var(--im-site-grid-spacing);
  background-position: center center;
  z-index: -10; pointer-events: none; opacity: 0.5; /* Even more subtle */
}

/* Typography Overrides */
.title, .subtitle, h1, h2, h3, h4, h5, h6 {
  font-family: var(--im-font-family-sans-serif);
  word-break: break-word;
}
.title { /* Overrides Bulma .title */
  color: var(--im-color-text-headings) !important;
  font-weight: 700 !important; /* Bolder for Enji.dev feel */
  line-height: 1.15 !important;
}
.subtitle { /* Overrides Bulma .subtitle */
  color: var(--im-color-text-muted) !important;
  font-weight: 400 !important;
  line-height: 1.4 !important;
}
/* Keep Bulma's .is-1 to .is-6 for title/subtitle sizing */

p { margin-bottom: var(--im-spacing-unit); } /* Consistent paragraph spacing */

a:not(.button):not(.navbar-item):not(.dropdown-item):not(.panel-block):not(.tag):not(.card-footer-item) {
  color: var(--im-color-link);
  font-weight: 500; /* Medium weight for standalone links */
  text-decoration: none;
  transition: color var(--im-base-transition-duration) ease;
}
a:not(.button):not(.navbar-item):not(.dropdown-item):not(.panel-block):not(.tag):not(.card-footer-item):hover {
  color: var(--im-color-link-hover);
  /* text-decoration: underline; */ /* Optional */
}

strong { color: var(--im-color-text-headings) !important; font-weight: 600 !important; }
hr { background-color: var(--im-color-border); height: 1px; border: none; margin: 2rem 0; }

.im-main-content-area { /* For JS to manage padding with scrolling navbar */
    padding-top: var(--im-navbar-height);
    transition: padding-top var(--im-navbar-scroll-transition-duration) ease-out;
}


/* ==========================================================================
   3. BULMA COMPONENT OVERRIDES (Pure CSS Overrides)
   ========================================================================== */

/* --- Layout --- */
.section {
  padding: var(--im-section-padding-vertical) 1.5rem; /* More vertical space */
}

.hero.is-primary {
  background-color: var(--im-color-primary) !important;
  color: var(--im-color-primary-inverse) !important;
}
.hero.is-primary .title,
.hero.is-primary .subtitle {
  color: var(--im-color-primary-inverse) !important;
}
.hero.is-primary .button.is-light {
    background-color: var(--im-color-primary-inverse) !important;
    border-color: var(--im-color-primary-inverse) !important;
    color: var(--im-color-primary) !important;
}
.hero.is-primary .button.is-light:hover {
    background-color: rgba(255,255,255,0.95) !important;
    border-color: rgba(255,255,255,0.95) !important;
}

.footer {
  background-color: var(--im-color-surface-alt);
  color: var(--im-color-text-muted);
  padding: var(--im-section-padding-vertical) 1.5rem;
  border-top: 1px solid var(--im-color-border);
  font-size: 0.9em;
}
.footer a { color: var(--im-color-text); font-weight: 500; }
.footer a:hover { color: var(--im-color-link-hover); }


/* --- Elements --- */
.button {
  font-family: var(--im-font-family-sans-serif);
  font-weight: 500; /* Medium weight for buttons */
  border-radius: var(--im-border-radius);
  transition: all var(--im-base-transition-duration) ease;
  box-shadow: 0 2px 3px rgba(0,0,0,0.04); /* Softer shadow */
  border-width: 1px; /* Ensure border is visible for non-colored buttons */
}
.button:active { transform: translateY(1px); box-shadow: 0 1px 1px rgba(0,0,0,0.04); }

/* .button.is-primary is themed by $primary via main.scss */
.button.is-light { /* Custom .is-light to use IM theme vars */
  background-color: var(--im-button-light-bg) !important;
  border-color: var(--im-button-light-border) !important;
  color: var(--im-button-light-text) !important;
}
.button.is-light:hover {
  background-color: var(--im-button-light-hover-bg) !important;
  border-color: var(--im-button-light-hover-border) !important;
}

.box {
  background-color: var(--im-color-surface);
  border-radius: var(--im-border-radius-large);
  box-shadow: 0 8px 24px rgba(100, 116, 139, 0.08); /* Enji.dev often has diffused shadows */
  border: 1px solid var(--im-color-border-light);
  padding: var(--im-content-padding);
  color: var(--im-color-text-on-surface);
}

.content code { /* Code within .content */
  background-color: var(--im-color-surface-alt);
  border: 1px solid var(--im-color-border-light);
  color: var(--im-color-primary-dark);
  padding: 0.2em 0.45em;
  border-radius: var(--im-border-radius);
  font-size: 0.9em;
  font-family: var(--im-font-family-monospace);
}
.content pre {
  background-color: #1e293b; /* Darker background for code blocks like Enji */
  color: #e2e8f0; /* Light text on dark pre */
  border: 1px solid #334155; /* Darker border */
  border-radius: var(--im-border-radius);
  padding: 1.25em;
  overflow-x: auto;
  white-space: pre;
}
html.im-is-dark-mode .content pre { /* Keep pre dark even in light mode, adjust if needed */
    background-color: #0f172a; /* Even darker for dark mode */
    border-color: #1e293b;
    color: #cbd5e1;
}
.content pre code { /* Code inside pre */
  background-color: transparent !important;
  border: none !important;
  padding: 0 !important;
  color: inherit !important; /* Inherit from pre */
  font-size: inherit !important;
}
.content blockquote {
  background-color: var(--im-color-surface-alt);
  border-left: 3px solid var(--im-color-primary);
  padding: 1.25em 1.5em; /* More padding */
  color: var(--im-color-text-muted);
  border-radius: 0 var(--im-border-radius) var(--im-border-radius) 0;
}

.icon { color: var(--im-icon-color); }
.icon i.ph { vertical-align: -0.15em; font-size: 1.1em; }
a:hover > .icon, button:hover > .icon,
a:hover > .icon-text > .icon, button:hover > .icon-text > .icon {
  color: var(--im-icon-color-hover);
}

figure.image img { border-radius: var(--im-border-radius); }
.tag { border-radius: var(--im-border-radius); font-weight: 500; }
.tag.is-light {
    background-color: var(--im-button-light-bg);
    color: var(--im-button-light-text);
}

/* --- Components --- */
.card {
  background-color: var(--im-color-surface);
  border-radius: var(--im-border-radius-large);
  box-shadow: 0 10px 30px rgba(100, 116, 139, 0.07); /* Diffused shadow */
  border: 1px solid var(--im-color-border);
}
.card-header {
  background-color: transparent;
  border-bottom: 1px solid var(--im-color-border-light);
  box-shadow: none; padding: 1rem var(--im-content-padding);
}
.card-header-title { color: var(--im-color-text-headings); font-weight: 600; }
.card-content { padding: var(--im-content-padding); }
.card-footer {
  background-color: transparent;
  border-top: 1px solid var(--im-color-border-light);
  padding: 1rem var(--im-content-padding);
}

/* Navbar (im-navbar-custom is your class on the nav element) */
.navbar.im-navbar-custom {
  min-height: var(--im-navbar-height) !important;
  background-color: var(--im-navbar-bg-transparent) !important;
  backdrop-filter: blur(12px) saturate(180%);
  -webkit-backdrop-filter: blur(12px) saturate(180%);
  border-bottom: 1px solid var(--im-navbar-border-transparent);
  transition: transform var(--im-navbar-scroll-transition-duration) ease-out,
              background-color var(--im-navbar-scroll-transition-duration) ease-out,
              border-color var(--im-navbar-scroll-transition-duration) ease-out,
              box-shadow var(--im-navbar-scroll-transition-duration) ease-out;
  /* is-fixed-top handles fixed positioning from Bulma */
}
.navbar.im-navbar-custom.is-visible {
  transform: translateY(0%);
  background-color: var(--im-navbar-bg-scrolled) !important;
  border-bottom-color: var(--im-navbar-border-scrolled);
  box-shadow: 0 2px 4px rgba(0,0,0,0.02); /* Very subtle shadow when visible */
}
.navbar.im-navbar-custom.is-hidden-scroll { transform: translateY(-100%); }

.navbar-brand { min-height: var(--im-navbar-height); }
.navbar-brand .navbar-item { padding-top:0; padding-bottom:0; display:flex; align-items:center; }

@media screen and (max-width: 1023px) { /* Bulma's $desktop - 1px */
  .navbar-menu.is-active {
    background-color: var(--im-color-surface);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    padding: 0.5rem 0;
    border-radius: 0 0 var(--im-border-radius) var(--im-border-radius);
    border: 1px solid var(--im-color-border); border-top: none;
    position: absolute; left: 0; right: 0; top: 100%; z-index: 20;
  }
}
.navbar-item, .navbar-link {
  color: var(--im-color-text) !important;
  font-weight: 500 !important;
  padding: 0.75rem 1rem !important; /* Use values from CSS vars if defined, or direct */
  min-height: var(--im-navbar-height);
  display: flex; align-items: center; position: relative;
  transition: color var(--im-base-transition-duration) ease;
}
.navbar-item .icon i.ph, .navbar-link .icon i.ph { transition: color var(--im-base-transition-duration) ease; }

.navbar-item:hover, .navbar-link:hover,
.navbar-item.is-hovered, .navbar-link.is-hovered {
  background-color: transparent !important;
  color: var(--im-color-primary) !important;
}
.navbar-item:hover .icon i.ph, .navbar-link:hover .icon i.ph,
.navbar-item.is-hovered .icon i.ph, .navbar-link.is-hovered .icon i.ph {
    color: var(--im-color-primary) !important;
}

.navbar-item.is-active-nav-item, .navbar-link.is-active-nav-item { /* Your custom class */
  color: var(--im-color-primary) !important;
  font-weight: 600 !important;
  background-color: transparent !important;
}
.navbar-item.is-active-nav-item .icon i.ph, .navbar-link.is-active-nav-item .icon i.ph {
    color: var(--im-color-primary) !important;
}
.navbar-item.is-active-nav-item::after, .navbar-link.is-active-nav-item::after {
  content: ''; position: absolute; bottom: 6px; left: 50%; transform: translateX(-50%);
  width: 0; height: 0; border-left: 5px solid transparent;
  border-right: 5px solid transparent; border-bottom: 5px solid var(--im-color-primary);
}

.navbar-link::after { /* Bulma's arrow */
  border-color: var(--im-color-text-muted) !important;
  right: 1rem; /* Consistent with item padding */
}
.navbar-link:hover::after, .navbar-link.is-active-nav-item::after {
    /* The main active indicator is the triangle. Arrow color change on hover is good. */
}
.navbar-dropdown {
  background-color: var(--im-color-surface) !important;
  border: 1px solid var(--im-color-border) !important;
  border-top: none !important;
  border-radius: 0 0 var(--im-border-radius) var(--im-border-radius) !important;
  box-shadow: 0 8px 20px rgba(0,0,0,0.07) !important; /* Softer dropdown shadow */
  padding-top: 0.3rem !important; padding-bottom: 0.3rem !important;
  font-size: 0.925em;
}
.navbar-dropdown .navbar-item {
  padding: 0.6rem 1.25rem !important; /* Consistent padding */
  min-height: auto; color: var(--im-color-text) !important;
}
.navbar-dropdown .navbar-item:hover {
  background-color: var(--im-color-surface-alt) !important;
  color: var(--im-color-primary) !important;
}
.navbar-dropdown .navbar-item.is-active-nav-item {
  background-color: rgba(var(--im-color-primary-rgb), 0.07) !important; /* Subtle active bg */
  color: var(--im-color-primary-dark) !important;
  font-weight: 500 !important;
}
.navbar-dropdown .navbar-item.is-active-nav-item::after { display: none; }

/* Your custom classes for logo and icons in navbar */
.im-logo-link .im-logo-image { max-height: calc(var(--im-navbar-height) * 0.5); margin-right: 0.6rem;}
.im-logo-link .im-logo-text { font-size: 1.2rem; color: var(--im-color-text-headings); font-weight: 700;}
.im-nav-icon { margin-right: 0.5em; }
.im-nav-icon i.ph { font-size: 1.2em; }
.im-nav-image-icon { max-height: 1.25rem; margin-right: 0.5em; }
.im-nav-image-icon.is-small { max-height: 1rem; }

.navbar-brand .navbar-item.is-hidden-desktop { margin-left: auto; /* Push mobile icons to right */ }
.im-navbar-mobile-action .icon i.ph,
.navbar-end .im-dark-mode-toggle .icon i.ph { /* Covers desktop and mobile toggle */
    color: var(--im-icon-color);
}
.im-navbar-mobile-action:hover .icon i.ph,
.navbar-end .im-dark-mode-toggle:hover .icon i.ph {
    color: var(--im-icon-color-hover);
}

/* --- Forms --- */
.input, .textarea, .select select {
  font-family: var(--im-font-family-sans-serif);
  border-radius: var(--im-border-radius);
  border: 1px solid var(--im-input-border);
  box-shadow: none;
  background-color: var(--im-input-bg);
  color: var(--im-input-text);
  transition: border-color var(--im-base-transition-duration) ease, box-shadow var(--im-base-transition-duration) ease;
  padding: 0.75em 1em; /* Consistent padding */
}
.input::placeholder, .textarea::placeholder {
  color: var(--im-input-placeholder-text);
  opacity: 0.7;
}
.input:hover, .textarea:hover, .select:hover select { /* Target select wrapper for hover on select */
  border-color: var(--im-color-border-hover);
}
.input:focus, .textarea:focus, .select select:focus,
.input.is-focused, .textarea.is-focused, .select select.is-focused,
.input:active, .textarea:active, .select select:active,
.input.is-active, .textarea.is-active, .select select.is-active {
  border-color: var(--im-input-focus-border) !important;
  box-shadow: 0 0 0 0.125em var(--im-input-focus-shadow) !important;
}
.textarea { line-height: 1.65; }
.select:not(.is-multiple):not(.is-loading)::after { /* Dropdown arrow */
  border-color: var(--im-color-primary);
  right: 1.25em; /* Adjust arrow position */
}
.label {
  color: var(--im-color-text-headings);
  font-weight: 600; /* Bulma default is 700 */
  margin-bottom: 0.5em;
}
.help {
  color: var(--im-color-text-muted);
  font-size: 0.9rem;
  margin-top: 0.25em;
}

/* ==========================================================================
   4. PAGE TRANSITION ANIMATIONS (Load animation off)
   ========================================================================== */
body.im-page-is-loading { opacity: 1; }
body.im-page-is-entering { opacity: 1; } /* No fade-in animation on load */
body.im-page-is-exiting {
  animation: imPageFadeOutDown var(--im-page-transition-duration-css, 0.2s) forwards ease-in !important;
}
@keyframes imPageFadeOutDown {
  from { opacity: 1; transform: translateY(0); }
  to   { opacity: 0; transform: translateY(10px); } /* Use fixed value or CSS var if defined */
}