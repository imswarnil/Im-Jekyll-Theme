<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
  {% include im-head.html %}
  <body>
    {% include im-navbar.html %}

    <!-- Documentation Layout -->
    <div class="docs-layout">
      <!-- Mobile Menu Toggle -->
      <button class="docs-mobile-menu-toggle button is-primary is-hidden-desktop" id="docsMenuToggle">
        <span class="icon">
          <i class="fas fa-bars"></i>
        </span>
        <span>Menu</span>
      </button>

      <!-- Left Sidebar - Documentation Menu -->
      <aside class="docs-sidebar is-hidden-mobile" id="docsSidebar">
        <div class="docs-sidebar-inner">
          <!-- Search Box -->
          <div class="docs-search box is-shadowless mb-4">
            <div class="field has-addons">
              <div class="control is-expanded">
                <input class="input is-small" type="text" placeholder="Search documentation...">
              </div>
              <div class="control">
                <button class="button is-small is-primary">
                  <span class="icon">
                    <i class="fas fa-search"></i>
                  </span>
                </button>
              </div>
            </div>
          </div>

          <!-- Documentation Menu -->
          <div class="docs-menu">
            {% for item in site.data.documentation.docs %}
              <p class="menu-label">
                <span class="icon-text">
                  <span class="icon">
                    <i class="{{ item.icon }}"></i>
                  </span>
                  <span>{{ item.label }}</span>
                </span>
              </p>
              <ul class="menu-list">
                {% for subitem in item.items %}
                  {% if subitem.items %}
                    <li>
                      <a class="has-text-weight-bold">{{ subitem.name }}</a>
                      <ul>
                        {% for subsubitem in subitem.items %}
                          <li>
                            <a href="{{ site.baseurl }}{{ subsubitem.link }}" 
                               class="{% if page.url == subsubitem.link %}is-active{% endif %}">
                              {{ subsubitem.name }}
                            </a>
                          </li>
                        {% endfor %}
                      </ul>
                    </li>
                  {% else %}
                    <li>
                      <a href="{{ site.baseurl }}{{ subitem.link }}" 
                         class="{% if page.url == subitem.link %}is-active{% endif %}">
                        {{ subitem.name }}
                      </a>
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            {% endfor %}
          </div>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="docs-main">
        <!-- Breadcrumbs -->
        <nav class="docs-breadcrumb breadcrumb" aria-label="breadcrumbs">
          <ul>
            <li><a href="{{ site.baseurl }}/">Home</a></li>
            <li><a href="{{ site.baseurl }}/docs/">Documentation</a></li>
            {% if page.category %}
              <li><a href="#">{{ page.category }}</a></li>
            {% endif %}
            <li class="is-active"><a href="#" aria-current="page">{{ page.title }}</a></li>
          </ul>
        </nav>

        <!-- Page Header -->
        <header class="docs-header mb-5">
          <h1 class="title is-2">{{ page.title }}</h1>
          {% if page.subtitle %}
            <p class="subtitle is-4 has-text-grey">{{ page.subtitle }}</p>
          {% endif %}
        </header>

        <!-- Content -->
        <div class="docs-content content">
          {{ content }}
        </div>

        <!-- Page Footer with Feedback and Navigation -->
        <footer class="docs-footer mt-6">
          <div class="docs-feedback box is-shadowless">
            <div class="field is-grouped is-grouped-multiline">
              <div class="control">
                <p>Was this helpful?</p>
              </div>
              <div class="control">
                <button class="button is-small is-success">
                  <span class="icon">
                    <i class="fas fa-thumbs-up"></i>
                  </span>
                  <span>Yes</span>
                </button>
              </div>
              <div class="control">
                <button class="button is-small is-danger">
                  <span class="icon">
                    <i class="fas fa-thumbs-down"></i>
                  </span>
                  <span>No</span>
                </button>
              </div>
            </div>
          </div>

          <div class="docs-pagination columns">
            {% if page.previous %}
              <div class="column is-6">
                <a href="{{ site.baseurl }}{{ page.previous.url }}" class="docs-pagination-link box">
                  <div class="icon-text">
                    <span class="icon">
                      <i class="fas fa-arrow-left"></i>
                    </span>
                    <span>
                      <span class="has-text-grey is-size-7">Previous</span>
                      <p class="is-size-5">{{ page.previous.title }}</p>
                    </span>
                  </div>
                </a>
              </div>
            {% endif %}
            {% if page.next %}
              <div class="column is-6">
                <a href="{{ site.baseurl }}{{ page.next.url }}" class="docs-pagination-link box">
                  <div class="icon-text is-flex-direction-row-reverse">
                    <span class="icon">
                      <i class="fas fa-arrow-right"></i>
                    </span>
                    <span class="has-text-right">
                      <span class="has-text-grey is-size-7">Next</span>
                      <p class="is-size-5">{{ page.next.title }}</p>
                    </span>
                  </div>
                </a>
              </div>
            {% endif %}
          </div>
        </footer>
      </main>

      <!-- Right Sidebar - Table of Contents -->
      <aside class="docs-toc is-hidden-mobile">
        <div class="docs-toc-inner">
          <div class="menu">
            <p class="menu-label">On this page</p>
            {% include utility/toc.html html=content class="menu-list" h_min=2 h_max=3 %}
          </div>

          <div class="docs-ad box mt-5">
            <span class="tag is-light is-small is-uppercase">Advertisement</span>
            <div class="docs-ad-content mt-2">
              <!-- Ad content would go here -->
              <img src="https://via.placeholder.com/250" alt="Advertisement" style="border-radius: 4px;">
            </div>
          </div>

          <div class="docs-author box mt-5">
            <article class="media">
              <figure class="media-left">
                <p class="image is-48x48">
                  <img class="is-rounded" src="https://via.placeholder.com/48" alt="Author avatar">
                </p>
              </figure>
              <div class="media-content">
                <div class="content">
                  <p>
                    <strong>Documentation Team</strong>
                    <br>
                    <small class="has-text-grey">Last updated: {{ page.last_modified_at | date: "%b %d, %Y" }}</small>
                  </p>
                </div>
              </div>
            </article>
          </div>

          <div class="docs-social-share box mt-5">
            <p class="menu-label">Share this page</p>
            <div class="field is-grouped">
              <p class="control">
                <a class="button is-small" aria-label="Twitter">
                  <span class="icon">
                    <i class="fab fa-twitter"></i>
                  </span>
                </a>
              </p>
              <p class="control">
                <a class="button is-small" aria-label="LinkedIn">
                  <span class="icon">
                    <i class="fab fa-linkedin"></i>
                  </span>
                </a>
              </p>
              <p class="control">
                <a class="button is-small" aria-label="Facebook">
                  <span class="icon">
                    <i class="fab fa-facebook"></i>
                  </span>
                </a>
              </p>
              <p class="control">
                <a class="button is-small" aria-label="Copy link">
                  <span class="icon">
                    <i class="fas fa-link"></i>
                  </span>
                </a>
              </p>
            </div>
          </div>
        </div>
      </aside>
    </div>

    {% include footer.html %}

    <!-- Custom CSS -->
    <style>
      /* Documentation Layout */
      .docs-layout {
        display: flex;
        min-height: calc(100vh - 3.25rem); /* Adjust based on your navbar height */
      }

      /* Sidebar */
      .docs-sidebar {
        width: 280px;
        background-color: #f5f5f5;
        border-right: 1px solid #dbdbdb;
        padding: 1.5rem;
        overflow-y: auto;
        position: sticky;
        top: 3.25rem; /* Height of your navbar */
        height: calc(100vh - 3.25rem);
        z-index: 30;
      }

      .docs-sidebar-inner {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .docs-menu {
        flex-grow: 1;
        overflow-y: auto;
      }

      /* Main Content */
      .docs-main {
        flex-grow: 1;
        padding: 2rem 3rem;
        max-width: 800px;
        margin: 0 auto;
      }

      .docs-header {
        border-bottom: 1px solid #dbdbdb;
        padding-bottom: 1.5rem;
      }

      /* Table of Contents */
      .docs-toc {
        width: 260px;
        padding: 2rem 1.5rem;
        position: sticky;
        top: 3.25rem; /* Height of your navbar */
        height: calc(100vh - 3.25rem);
        overflow-y: auto;
      }

      /* Mobile Menu Toggle */
      .docs-mobile-menu-toggle {
        position: fixed;
        bottom: 1rem;
        right: 1rem;
        z-index: 40;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }

      /* Pagination Links */
      .docs-pagination-link {
        transition: all 0.2s ease;
      }
      .docs-pagination-link:hover {
        background-color: #f5f5f5;
      }

      /* Responsive Adjustments */
      @media screen and (max-width: 1023px) {
        .docs-toc {
          display: none;
        }
        
        .docs-main {
          padding: 1.5rem;
          width: 100%;
        }
      }

      @media screen and (max-width: 768px) {
        .docs-sidebar {
          position: fixed;
          left: -280px;
          top: 3.25rem;
          transition: left 0.3s ease;
        }
        
        .docs-sidebar.is-active {
          left: 0;
        }
      }
    </style>

    <!-- JavaScript -->
    <script>
      // Mobile menu toggle
      document.addEventListener('DOMContentLoaded', () => {
        const menuToggle = document.getElementById('docsMenuToggle');
        const sidebar = document.getElementById('docsSidebar');
        
        if (menuToggle && sidebar) {
          menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('is-active');
          });
        }

        // Highlight current section in TOC while scrolling
        const sections = document.querySelectorAll('h2, h3');
        const menuLinks = document.querySelectorAll('.docs-toc .menu-list a');
        
        window.addEventListener('scroll', () => {
          let current = '';
          
          sections.forEach(section => {
            const sectionTop = section.offsetTop;
            if (window.scrollY >= sectionTop - 100) {
              current = '#' + section.id;
            }
          });
          
          menuLinks.forEach(link => {
            link.classList.remove('is-active');
            if (link.getAttribute('href') === current) {
              link.classList.add('is-active');
            }
          });
        });
      });
    </script>

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "TechArticle",
      "headline": "{{ page.title }}",
      "description": "{{ page.description | default: page.excerpt | strip_html | strip_newlines | truncate: 160 }}",
      "author": {
        "@type": "Organization",
        "name": "{{ site.title }}"
      },
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "dateModified": "{{ page.last_modified_at | default: page.date | date_to_xmlschema }}",
      "publisher": {
        "@type": "Organization",
        "name": "{{ site.title }}",
        "logo": {
          "@type": "ImageObject",
          "url": "{{ site.logo | absolute_url }}"
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ page.url | absolute_url }}"
      }
    }
    </script>

    {% include site-before-end.html %}
  </body>
</html>