<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}" class=" {% if site.fixed_navbar %} has-navbar-fixed-top {% endif %}" >
{% include im-head.html %}
<body class="layout-{{ page.layout | default: 'default'}}">
    {% include im-navbar.html %}
    <div class="content"> 
        {{ content }} <!-- This is where your markdown gets rendered -->
    </div>
   {% include site-before-end.html %}
   {% include head/sw.html %}
   <script>
    document.addEventListener('DOMContentLoaded', () => {
    const themeToggle = document.getElementById('imDarkModeToggle');
    const htmlElement = document.documentElement;
    const bodyElement = document.body;

    // --- Theme Toggle Logic ---
    const updateToggleIcon = (isDarkMode) => {
        if (themeToggle) {
            const iconElement = themeToggle.querySelector('i.ph');
            if (iconElement) {
                iconElement.className = isDarkMode ? 'ph ph-sun' : 'ph ph-moon';
            }
            themeToggle.setAttribute('aria-pressed', isDarkMode.toString());
        }
    };

    const applyTheme = (theme) => {
        const isDarkMode = theme === 'dark';
        if (isDarkMode) {
            htmlElement.classList.add('im-is-dark-mode');
        } else {
            htmlElement.classList.remove('im-is-dark-mode');
        }
        updateToggleIcon(isDarkMode);
    };

    // Check localStorage for saved theme
    let currentTheme = localStorage.getItem('im-theme');
    if (!currentTheme) {
        currentTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    applyTheme(currentTheme); // Apply initial theme

    // Event listener for the toggle
    if (themeToggle) {
        themeToggle.addEventListener('click', (event) => {
            event.preventDefault();
            const newTheme = htmlElement.classList.contains('im-is-dark-mode') ? 'light' : 'dark';
            applyTheme(newTheme);
            localStorage.setItem('im-theme', newTheme);
        });
    }

    // --- Page Transition Logic ---
    if (bodyElement.classList.contains('im-page-is-loading')) {
        bodyElement.classList.remove('im-page-is-loading');
    }
    if (performance.navigation.type !== performance.navigation.TYPE_BACK_FORWARD) {
        requestAnimationFrame(() => {
             bodyElement.classList.add('im-page-is-entering');
        });
    }

    const internalLinks = document.querySelectorAll('a[href]:not([href^="#"]):not([href^="mailto:"]):not([href^="tel:"]):not([target="_blank"])');
    const transitionDurationString = getComputedStyle(document.documentElement).getPropertyValue('--im-page-transition-duration') || '0.3s';
    const transitionDuration = parseFloat(transitionDurationString.replace('s', '')) * 1000;

    internalLinks.forEach(link => {
      link.addEventListener('click', function(event) {
        const href = this.getAttribute('href');
        if (href && (href.startsWith('/') || href.startsWith('.') || href.startsWith(window.location.origin) || !href.includes(':'))) {
          if (!event.metaKey && !event.ctrlKey) { // Allow opening in new tab
            event.preventDefault();
            bodyElement.classList.remove('im-page-is-entering'); // Clear current animation
            bodyElement.classList.add('im-page-is-exiting');
            setTimeout(() => {
              window.location.href = href;
            }, transitionDuration);
          }
        }
      });
    });

    window.addEventListener('pageshow', function(event) {
      if (event.persisted) {
        bodyElement.classList.remove('im-page-is-exiting', 'im-page-is-loading');
        requestAnimationFrame(() => {
             bodyElement.classList.add('im-page-is-entering');
        });
      }
    });
});
   </script>
   <script src="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2"></script>
</body>
</html>