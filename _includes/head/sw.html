<script type="text/javascript">
    (() => {
      const registerServiceWorker = () => {
        if (!navigator.serviceWorker) {
          return;
        }
        navigator.serviceWorker
          .register("{{ "/assets/scripts/sw.js" | relative_url }}") // Registers the SW file
          .then(registration => {
            // Optional: Listen for updates
            registration.onupdatefound = () => {
              const installingWorker = registration.installing;
              if (installingWorker) {
                installingWorker.onstatechange = () => {
                  // You can add console logs here if needed for debugging states
                };
              }
            };
          })
          .catch(err => {
            console.error("SW registration failed: ", err);
          });
          // Optional: Listener for when a new SW takes control
          navigator.serviceWorker.addEventListener('controllerchange', () => {
             // Can trigger actions like reload if needed
          });
      };
      window.addEventListener('load', registerServiceWorker);
    })();
    </script>