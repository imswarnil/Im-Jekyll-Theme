{% comment %}
  Reusable Hero Component for Jekyll
  Usage: {% include hero.html
            hero_size="is-medium" (is-small, is-medium, is-large, is-fullheight, is-fullheight-with-navbar)
            hero_class="is-primary has-text-centered" (any Bulma color/helper classes)
            hero_title="Page Title"
            hero_subtitle="A catchy subtitle"
            hero_layout_type=layout.name (pass layout.name to determine specific elements like breadcrumbs)
            hero_collection_name=page.collection (for breadcrumbs if in a collection)
            hero_collection_label="Blog" (display label for the collection)
            hero_breadcrumbs=true (or false)
            hero_buttons='[
              {"label": "Get Started", "url": "/start/", "class": "is-primary is-large"},
              {"label": "Learn More", "url": "/about/", "class": "is-light"}
            ]' (JSON string for buttons)
            hero_background_image="/assets/images/hero-bg.jpg"
            hero_background_video="/assets/videos/hero-bg.mp4" (will take precedence over image)
            hero_background_video_poster="/assets/images/video-poster.jpg"
            hero_overlay_opacity="0.5" (0 to 1 for background image/video overlay)
            hero_content_custom_html="<p>Some <em>custom HTML</em> here.</p>" (for custom content within hero-body)
         %}
{% endcomment %}

{% comment %} --- Initialize Variables --- {% endcomment %}
{% assign hero_size = include.hero_size | default: page.hero_size | default: "is-medium" %}
{% assign hero_class = include.hero_class | default: page.hero_class | default: "is-primary" %}
{% assign hero_title = include.hero_title | default: page.title | default: "Welcome" %}
{% assign hero_subtitle = include.hero_subtitle | default: page.hero_subtitle | default: "This is a beautiful hero section." %}
{% assign hero_layout_type = include.hero_layout_type | default: layout.name %}
{% assign hero_collection_name = include.hero_collection_name | default: page.collection %}
{% assign hero_collection_label = include.hero_collection_label | default: page.collection_label | default: hero_collection_name | capitalize %}
{% if include.hero_breadcrumbs == false %}
  {% assign hero_breadcrumbs = false %}
{% elsif include.hero_breadcrumbs == true or page.hero_breadcrumbs == true %}
  {% assign hero_breadcrumbs = true %}
{% else %}
  {% assign hero_breadcrumbs = false %}
  {% if hero_layout_type == "post" or hero_layout_type == "page" %}
    {% assign hero_breadcrumbs = true %}
  {% endif %}
{% endif %}

{% assign hero_buttons_json = include.hero_buttons | default: page.hero_buttons %}
{% if hero_buttons_json %}
  {% assign hero_buttons = hero_buttons_json | parse_json %}
{% else %}
  {% assign hero_buttons = nil %}
{% endif %}

{% assign hero_background_image = include.hero_background_image | default: page.hero_background_image %}
{% assign hero_background_video = include.hero_background_video | default: page.hero_background_video %}
{% assign hero_background_video_poster = include.hero_background_video_poster | default: page.hero_background_video_poster %}
{% assign hero_overlay_opacity = include.hero_overlay_opacity | default: page.hero_overlay_opacity | default: "0" %}
{% assign hero_content_custom_html = include.hero_content_custom_html | default: page.hero_content_custom_html %}

{% comment %} --- Dynamic Class for Background --- {% endcomment %}
{% assign hero_wrapper_class = "" %}
{% if hero_background_video %}
  {% assign hero_wrapper_class = hero_wrapper_class | append: " has-video-background" %}
{% elsif hero_background_image %}
  {% assign hero_wrapper_class = hero_wrapper_class | append: " has-image-background" %}
{% endif %}

<section class="hero {{ hero_size }} {{ hero_class }} {{ hero_wrapper_class }}"
         {% if hero_background_image and hero_background_video == nil %}
           style="background-image: url('{{ hero_background_image | relative_url }}');"
         {% endif %}>

  {% if hero_background_video or hero_background_image %}
    <div class="hero-background-overlay" {% if hero_overlay_opacity != "0" %}style="background-color: rgba(0,0,0, {{ hero_overlay_opacity }});"{% endif %}></div>
  {% endif %}

  {% if hero_background_video %}
    <video playsinline autoplay muted loop {% if hero_background_video_poster %}poster="{{ hero_background_video_poster | relative_url }}"{% endif %} class="hero-background-video">
      <source src="{{ hero_background_video | relative_url }}" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  {% endif %}

  <div class="hero-head">
    {% if hero_breadcrumbs %}
    <nav class="breadcrumb is-centered has-text-centered hero-breadcrumbs" aria-label="breadcrumbs">
      <ul>
        <li><a href="{{ '/' | relative_url }}">Home</a></li>
        {% if hero_collection_name and hero_collection_name != "" %}
          {% assign collection_page_url = nil %}
          {% for col_page in site.pages %}
            {% if col_page.name == hero_collection_name or col_page.title == hero_collection_label or col_page.permalink == hero_collection_name %}
              {% assign collection_page_url = col_page.url | relative_url %}
              {% break %}
            {% endif %}
          {% endfor %}
          {% if collection_page_url %}
            <li><a href="{{ collection_page_url }}">{{ hero_collection_label }}</a></li>
          {% else %}
             <li><span class="inactive-breadcrumb">{{ hero_collection_label }}</span></li>
          {% endif %}
        {% endif %}
        {% if hero_layout_type == "post" or hero_layout_type == "page" %}
          <li class="is-active"><a href="{{ page.url | relative_url }}" aria-current="page">{{ hero_title }}</a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>

  <div class="hero-body">
    <div class="container has-text-centered">
      {% if hero_title %}
        <h1 class="title is-1 hero-main-title">
          {{ hero_title }}
        </h1>
      {% endif %}
      {% if hero_subtitle %}
        <p class="subtitle is-3 hero-main-subtitle">
          {{ hero_subtitle }}
        </p>
      {% endif %}

      {% if hero_buttons %}
        <div class="buttons is-centered hero-buttons-group">
          {% for button in hero_buttons %}
            <a href="{{ button.url | relative_url }}" class="button {{ button.class }}">
              {% if button.icon %}<span class="icon"><i class="{{ button.icon }}"></i></span>{% endif %}
              <span>{{ button.label }}</span>
            </a>
          {% endfor %}
        </div>
      {% endif %}

      {% if hero_content_custom_html %}
        <div class="hero-custom-content">
          {{ hero_content_custom_html }}
        </div>
      {% endif %}
    </div>
  </div>

  <div class="hero-foot">
    {% comment %}
      Example: You could place a secondary navigation or other elements here.
      {% include hero-foot-nav.html %}
    {% endcomment %}
  </div>
</section>